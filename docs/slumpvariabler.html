<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3 Slumpvariabler | R-anvisningar till Grundläggande statistik</title>
  <meta name="description" content="3 Slumpvariabler | R-anvisningar till Grundläggande statistik" />
  <meta name="generator" content="bookdown 0.34 and GitBook 2.6.7" />

  <meta property="og:title" content="3 Slumpvariabler | R-anvisningar till Grundläggande statistik" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3 Slumpvariabler | R-anvisningar till Grundläggande statistik" />
  
  
  



<meta name="date" content="2023-07-31" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="beskrivande-statistik.html"/>
<link rel="next" href="ett-stickprov-av-normalfördelad-data.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">R-anvisningar</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduktion</a></li>
<li class="chapter" data-level="" data-path="installation-av-r-och-rstudio.html"><a href="installation-av-r-och-rstudio.html"><i class="fa fa-check"></i>Installation av R och RStudio</a>
<ul>
<li class="chapter" data-level="0.1" data-path="installation-av-r-och-rstudio.html"><a href="installation-av-r-och-rstudio.html#inledning"><i class="fa fa-check"></i><b>0.1</b> Inledning</a></li>
<li class="chapter" data-level="0.2" data-path="installation-av-r-och-rstudio.html"><a href="installation-av-r-och-rstudio.html#installation-av-r"><i class="fa fa-check"></i><b>0.2</b> Installation av R</a></li>
<li class="chapter" data-level="0.3" data-path="installation-av-r-och-rstudio.html"><a href="installation-av-r-och-rstudio.html#installation-av-rstudio"><i class="fa fa-check"></i><b>0.3</b> Installation av RStudio</a></li>
<li class="chapter" data-level="0.4" data-path="installation-av-r-och-rstudio.html"><a href="installation-av-r-och-rstudio.html#gränssnittet-i-rstudio"><i class="fa fa-check"></i><b>0.4</b> Gränssnittet i RStudio</a></li>
<li class="chapter" data-level="0.5" data-path="installation-av-r-och-rstudio.html"><a href="installation-av-r-och-rstudio.html#paket-i-r"><i class="fa fa-check"></i><b>0.5</b> Paket i R</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="datahantering-och-grafer.html"><a href="datahantering-och-grafer.html"><i class="fa fa-check"></i><b>1</b> Datahantering och grafer</a>
<ul>
<li class="chapter" data-level="1.1" data-path="datahantering-och-grafer.html"><a href="datahantering-och-grafer.html#uppstart-och-orientering"><i class="fa fa-check"></i><b>1.1</b> Uppstart och orientering</a></li>
<li class="chapter" data-level="1.2" data-path="datahantering-och-grafer.html"><a href="datahantering-och-grafer.html#packages-från-cran"><i class="fa fa-check"></i><b>1.2</b> <em>Packages</em> från CRAN</a></li>
<li class="chapter" data-level="1.3" data-path="datahantering-och-grafer.html"><a href="datahantering-och-grafer.html#objekt-och-funktioner"><i class="fa fa-check"></i><b>1.3</b> Objekt och funktioner</a></li>
<li class="chapter" data-level="1.4" data-path="datahantering-och-grafer.html"><a href="datahantering-och-grafer.html#sekvenser-av-funktioner"><i class="fa fa-check"></i><b>1.4</b> Sekvenser av funktioner</a></li>
<li class="chapter" data-level="1.5" data-path="datahantering-och-grafer.html"><a href="datahantering-och-grafer.html#datainskrivning-och-dataimport-från-web"><i class="fa fa-check"></i><b>1.5</b> Datainskrivning och dataimport från web</a>
<ul>
<li class="chapter" data-level="1.5.1" data-path="datahantering-och-grafer.html"><a href="datahantering-och-grafer.html#inskrivning-av-data"><i class="fa fa-check"></i><b>1.5.1</b> Inskrivning av data</a></li>
<li class="chapter" data-level="1.5.2" data-path="datahantering-och-grafer.html"><a href="datahantering-och-grafer.html#import-från-en-extern-fil"><i class="fa fa-check"></i><b>1.5.2</b> Import från en extern fil</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="datahantering-och-grafer.html"><a href="datahantering-och-grafer.html#urval-ur-en-tabell-med-select-och-filter"><i class="fa fa-check"></i><b>1.6</b> Urval ur en tabell med <code>select</code> och <code>filter</code></a></li>
<li class="chapter" data-level="1.7" data-path="datahantering-och-grafer.html"><a href="datahantering-och-grafer.html#grafer-med-ggplot2"><i class="fa fa-check"></i><b>1.7</b> Grafer med <code>ggplot2</code></a></li>
<li class="chapter" data-level="1.8" data-path="datahantering-och-grafer.html"><a href="datahantering-och-grafer.html#bonus.-interaktiva-grafer-med-plotly"><i class="fa fa-check"></i><b>1.8</b> Bonus. Interaktiva grafer med <code>plotly</code></a></li>
<li class="chapter" data-level="1.9" data-path="datahantering-och-grafer.html"><a href="datahantering-och-grafer.html#bonus.-warming-stripes"><i class="fa fa-check"></i><b>1.9</b> Bonus. Warming stripes</a></li>
<li class="chapter" data-level="1.10" data-path="datahantering-och-grafer.html"><a href="datahantering-och-grafer.html#valfria-hemuppgifter"><i class="fa fa-check"></i><b>1.10</b> Valfria hemuppgifter</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="beskrivande-statistik.html"><a href="beskrivande-statistik.html"><i class="fa fa-check"></i><b>2</b> Beskrivande statistik</a>
<ul>
<li class="chapter" data-level="2.1" data-path="beskrivande-statistik.html"><a href="beskrivande-statistik.html#repetition-från-datorövning-1"><i class="fa fa-check"></i><b>2.1</b> Repetition från datorövning 1</a></li>
<li class="chapter" data-level="2.2" data-path="beskrivande-statistik.html"><a href="beskrivande-statistik.html#import-av-data-från-en-excelfil"><i class="fa fa-check"></i><b>2.2</b> Import av data från en Excelfil</a></li>
<li class="chapter" data-level="2.3" data-path="beskrivande-statistik.html"><a href="beskrivande-statistik.html#ändra-och-skapa-nya-kolumner-med-mutate"><i class="fa fa-check"></i><b>2.3</b> Ändra och skapa nya kolumner med <code>mutate</code></a></li>
<li class="chapter" data-level="2.4" data-path="beskrivande-statistik.html"><a href="beskrivande-statistik.html#sammanfattande-lägesmått"><i class="fa fa-check"></i><b>2.4</b> Sammanfattande lägesmått</a></li>
<li class="chapter" data-level="2.5" data-path="beskrivande-statistik.html"><a href="beskrivande-statistik.html#sammanfattande-spridningsmått"><i class="fa fa-check"></i><b>2.5</b> Sammanfattande spridningsmått</a></li>
<li class="chapter" data-level="2.6" data-path="beskrivande-statistik.html"><a href="beskrivande-statistik.html#ordna-upp-beskrivande-statistik-och-exportera"><i class="fa fa-check"></i><b>2.6</b> Ordna upp beskrivande statistik och exportera</a></li>
<li class="chapter" data-level="2.7" data-path="beskrivande-statistik.html"><a href="beskrivande-statistik.html#stegvis-beräkning-av-varians"><i class="fa fa-check"></i><b>2.7</b> Stegvis beräkning av varians</a></li>
<li class="chapter" data-level="2.8" data-path="beskrivande-statistik.html"><a href="beskrivande-statistik.html#kumulativt-medelvärde"><i class="fa fa-check"></i><b>2.8</b> Kumulativt medelvärde</a></li>
<li class="chapter" data-level="2.9" data-path="beskrivande-statistik.html"><a href="beskrivande-statistik.html#darwin-exempel"><i class="fa fa-check"></i><b>2.9</b> Darwin-exempel</a></li>
<li class="chapter" data-level="2.10" data-path="beskrivande-statistik.html"><a href="beskrivande-statistik.html#bonus.-tredimensionella-grafer-med-plotly"><i class="fa fa-check"></i><b>2.10</b> Bonus. Tredimensionella grafer med <code>plotly</code></a></li>
<li class="chapter" data-level="2.11" data-path="beskrivande-statistik.html"><a href="beskrivande-statistik.html#valfria-hemuppgifter-1"><i class="fa fa-check"></i><b>2.11</b> Valfria hemuppgifter</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="slumpvariabler.html"><a href="slumpvariabler.html"><i class="fa fa-check"></i><b>3</b> Slumpvariabler</a>
<ul>
<li class="chapter" data-level="3.1" data-path="slumpvariabler.html"><a href="slumpvariabler.html#repetition-från-datorövning-2"><i class="fa fa-check"></i><b>3.1</b> Repetition från datorövning 2</a></li>
<li class="chapter" data-level="3.2" data-path="slumpvariabler.html"><a href="slumpvariabler.html#diskreta-fördelningar-i-allmänhet"><i class="fa fa-check"></i><b>3.2</b> Diskreta fördelningar i allmänhet</a></li>
<li class="chapter" data-level="3.3" data-path="slumpvariabler.html"><a href="slumpvariabler.html#särskilda-diskreta-fördelningar-binomialfördelning"><i class="fa fa-check"></i><b>3.3</b> Särskilda diskreta fördelningar: binomialfördelning</a></li>
<li class="chapter" data-level="3.4" data-path="slumpvariabler.html"><a href="slumpvariabler.html#särskilda-diskreta-fördelningar-poissonfördelning"><i class="fa fa-check"></i><b>3.4</b> Särskilda diskreta fördelningar: poissonfördelning</a></li>
<li class="chapter" data-level="3.5" data-path="slumpvariabler.html"><a href="slumpvariabler.html#kontinuerliga-fördelningar-i-allmänhet"><i class="fa fa-check"></i><b>3.5</b> Kontinuerliga fördelningar i allmänhet</a></li>
<li class="chapter" data-level="3.6" data-path="slumpvariabler.html"><a href="slumpvariabler.html#särskilda-kontinuerliga-fördelningar-normalfördelningen"><i class="fa fa-check"></i><b>3.6</b> Särskilda kontinuerliga fördelningar: normalfördelningen</a></li>
<li class="chapter" data-level="3.7" data-path="slumpvariabler.html"><a href="slumpvariabler.html#bonus.-summan-av-två-slumpvariabler-med-slumptal"><i class="fa fa-check"></i><b>3.7</b> Bonus. Summan av två slumpvariabler med slumptal</a></li>
<li class="chapter" data-level="3.8" data-path="slumpvariabler.html"><a href="slumpvariabler.html#bonus.-cirkelns-area-från-slumptal"><i class="fa fa-check"></i><b>3.8</b> Bonus. Cirkelns area från slumptal</a></li>
<li class="chapter" data-level="3.9" data-path="slumpvariabler.html"><a href="slumpvariabler.html#bonus.-slump-och-ordning---sierpinski-triangeln"><i class="fa fa-check"></i><b>3.9</b> Bonus. Slump och ordning - Sierpinski-triangeln</a></li>
<li class="chapter" data-level="3.10" data-path="slumpvariabler.html"><a href="slumpvariabler.html#valfria-hemuppgifter-2"><i class="fa fa-check"></i><b>3.10</b> Valfria hemuppgifter</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="ett-stickprov-av-normalfördelad-data.html"><a href="ett-stickprov-av-normalfördelad-data.html"><i class="fa fa-check"></i><b>4</b> Ett stickprov av normalfördelad data</a>
<ul>
<li class="chapter" data-level="4.1" data-path="ett-stickprov-av-normalfördelad-data.html"><a href="ett-stickprov-av-normalfördelad-data.html#repetition-av-datorövning-3"><i class="fa fa-check"></i><b>4.1</b> Repetition av datorövning 3</a></li>
<li class="chapter" data-level="4.2" data-path="ett-stickprov-av-normalfördelad-data.html"><a href="ett-stickprov-av-normalfördelad-data.html#test-av-medelvärde-för-normalfördelad-data"><i class="fa fa-check"></i><b>4.2</b> Test av medelvärde för normalfördelad data</a></li>
<li class="chapter" data-level="4.3" data-path="ett-stickprov-av-normalfördelad-data.html"><a href="ett-stickprov-av-normalfördelad-data.html#konfidensintervall-för-normalfördelad-data"><i class="fa fa-check"></i><b>4.3</b> Konfidensintervall för normalfördelad data</a></li>
<li class="chapter" data-level="4.4" data-path="ett-stickprov-av-normalfördelad-data.html"><a href="ett-stickprov-av-normalfördelad-data.html#normalfördelad-data-och-centrala-gränsvärdesatsen"><i class="fa fa-check"></i><b>4.4</b> Normalfördelad data och centrala gränsvärdesatsen</a></li>
<li class="chapter" data-level="4.5" data-path="ett-stickprov-av-normalfördelad-data.html"><a href="ett-stickprov-av-normalfördelad-data.html#bonus.-simuleringar-för-t-test-och-konfidensintervall"><i class="fa fa-check"></i><b>4.5</b> Bonus. Simuleringar för t-test och konfidensintervall</a></li>
<li class="chapter" data-level="4.6" data-path="ett-stickprov-av-normalfördelad-data.html"><a href="ett-stickprov-av-normalfördelad-data.html#valfria-hemuppgifter-3"><i class="fa fa-check"></i><b>4.6</b> Valfria hemuppgifter</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="ett-stickprov-av-icke-normalfördelad-data.html"><a href="ett-stickprov-av-icke-normalfördelad-data.html"><i class="fa fa-check"></i><b>5</b> Ett stickprov av icke-normalfördelad data</a>
<ul>
<li class="chapter" data-level="5.1" data-path="ett-stickprov-av-icke-normalfördelad-data.html"><a href="ett-stickprov-av-icke-normalfördelad-data.html#repetition-av-datorövning-4"><i class="fa fa-check"></i><b>5.1</b> Repetition av datorövning 4</a></li>
<li class="chapter" data-level="5.2" data-path="ett-stickprov-av-icke-normalfördelad-data.html"><a href="ett-stickprov-av-icke-normalfördelad-data.html#proportioner-från-binär-data"><i class="fa fa-check"></i><b>5.2</b> Proportioner från binär data</a></li>
<li class="chapter" data-level="5.3" data-path="ett-stickprov-av-icke-normalfördelad-data.html"><a href="ett-stickprov-av-icke-normalfördelad-data.html#konfidensintervall-för-proportioner"><i class="fa fa-check"></i><b>5.3</b> Konfidensintervall för proportioner</a></li>
<li class="chapter" data-level="5.4" data-path="ett-stickprov-av-icke-normalfördelad-data.html"><a href="ett-stickprov-av-icke-normalfördelad-data.html#chi-två-test-för-goodness-of-fit"><i class="fa fa-check"></i><b>5.4</b> Chi-två-test för goodness-of-fit</a></li>
<li class="chapter" data-level="5.5" data-path="ett-stickprov-av-icke-normalfördelad-data.html"><a href="ett-stickprov-av-icke-normalfördelad-data.html#chi-två-test-när-någon-parameter-skattas-från-datan"><i class="fa fa-check"></i><b>5.5</b> Chi-två-test när någon parameter skattas från datan</a></li>
<li class="chapter" data-level="5.6" data-path="ett-stickprov-av-icke-normalfördelad-data.html"><a href="ett-stickprov-av-icke-normalfördelad-data.html#bonus.-interaktiva-kartor-med-leaflet"><i class="fa fa-check"></i><b>5.6</b> Bonus. Interaktiva kartor med leaflet</a></li>
<li class="chapter" data-level="5.7" data-path="ett-stickprov-av-icke-normalfördelad-data.html"><a href="ett-stickprov-av-icke-normalfördelad-data.html#valfria-hemuppgifter-4"><i class="fa fa-check"></i><b>5.7</b> Valfria hemuppgifter</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="test-för-två-stickprov.html"><a href="test-för-två-stickprov.html"><i class="fa fa-check"></i><b>6</b> Test för två stickprov</a>
<ul>
<li class="chapter" data-level="6.1" data-path="test-för-två-stickprov.html"><a href="test-för-två-stickprov.html#repetition-av-datorövning-5"><i class="fa fa-check"></i><b>6.1</b> Repetition av datorövning 5</a></li>
<li class="chapter" data-level="6.2" data-path="test-för-två-stickprov.html"><a href="test-för-två-stickprov.html#två-stickprov-och-normalfördelad-data"><i class="fa fa-check"></i><b>6.2</b> Två stickprov och normalfördelad data</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="test-för-två-stickprov.html"><a href="test-för-två-stickprov.html#t-test-för-två-matchade-stickprov"><i class="fa fa-check"></i><b>6.2.1</b> t-test för två matchade stickprov</a></li>
<li class="chapter" data-level="6.2.2" data-path="test-för-två-stickprov.html"><a href="test-för-två-stickprov.html#t-test-för-två-oberoende-stickprov"><i class="fa fa-check"></i><b>6.2.2</b> t-test för två oberoende stickprov</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="test-för-två-stickprov.html"><a href="test-för-två-stickprov.html#z-test-och-konfidensintervall-för-två-proportioner"><i class="fa fa-check"></i><b>6.3</b> z-test och konfidensintervall för två proportioner</a></li>
<li class="chapter" data-level="6.4" data-path="test-för-två-stickprov.html"><a href="test-för-två-stickprov.html#chi-två-test-för-korstabeller"><i class="fa fa-check"></i><b>6.4</b> Chi-två-test för korstabeller</a></li>
<li class="chapter" data-level="6.5" data-path="test-för-två-stickprov.html"><a href="test-för-två-stickprov.html#bonus.-bilder-i-r"><i class="fa fa-check"></i><b>6.5</b> Bonus. Bilder i R</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="variansanalys.html"><a href="variansanalys.html"><i class="fa fa-check"></i><b>7</b> Variansanalys</a>
<ul>
<li class="chapter" data-level="7.1" data-path="variansanalys.html"><a href="variansanalys.html#repetition-av-datorövning-6"><i class="fa fa-check"></i><b>7.1</b> Repetition av datorövning 6</a></li>
<li class="chapter" data-level="7.2" data-path="variansanalys.html"><a href="variansanalys.html#allmänt"><i class="fa fa-check"></i><b>7.2</b> Allmänt</a></li>
<li class="chapter" data-level="7.3" data-path="variansanalys.html"><a href="variansanalys.html#variansanalys.-en-faktor"><i class="fa fa-check"></i><b>7.3</b> Variansanalys. En faktor</a></li>
<li class="chapter" data-level="7.4" data-path="variansanalys.html"><a href="variansanalys.html#variansanalys.-en-faktor-med-block"><i class="fa fa-check"></i><b>7.4</b> Variansanalys. En faktor med block</a></li>
<li class="chapter" data-level="7.5" data-path="variansanalys.html"><a href="variansanalys.html#variansanalys.-två-faktorer-med-block"><i class="fa fa-check"></i><b>7.5</b> Variansanalys. Två faktorer med block</a></li>
<li class="chapter" data-level="7.6" data-path="variansanalys.html"><a href="variansanalys.html#modellantaganden-och-residualer"><i class="fa fa-check"></i><b>7.6</b> Modellantaganden och residualer</a></li>
<li class="chapter" data-level="7.7" data-path="variansanalys.html"><a href="variansanalys.html#bonus.-statistik-för-ekologi"><i class="fa fa-check"></i><b>7.7</b> Bonus. Statistik för ekologi</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="regression-och-korrelation.html"><a href="regression-och-korrelation.html"><i class="fa fa-check"></i><b>8</b> Regression och korrelation</a>
<ul>
<li class="chapter" data-level="8.1" data-path="regression-och-korrelation.html"><a href="regression-och-korrelation.html#repetition-av-datorövning-7"><i class="fa fa-check"></i><b>8.1</b> Repetition av datorövning 7</a></li>
<li class="chapter" data-level="8.2" data-path="regression-och-korrelation.html"><a href="regression-och-korrelation.html#regression"><i class="fa fa-check"></i><b>8.2</b> Regression</a></li>
<li class="chapter" data-level="8.3" data-path="regression-och-korrelation.html"><a href="regression-och-korrelation.html#korrelation"><i class="fa fa-check"></i><b>8.3</b> Korrelation</a></li>
<li class="chapter" data-level="8.4" data-path="regression-och-korrelation.html"><a href="regression-och-korrelation.html#bonus.-skrapa-data-från-webbsidor"><i class="fa fa-check"></i><b>8.4</b> Bonus. Skrapa data från webbsidor</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R-anvisningar till <em>Grundläggande statistik</em></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="slumpvariabler" class="section level1 hasAnchor" number="3">
<h1><span class="header-section-number">3</span> Slumpvariabler<a href="slumpvariabler.html#slumpvariabler" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Datorövning 3 handlar om sannolikhetslära i R. Efter övningen ska vi kunna</p>
<ul>
<li><p>Identifiera en passande slumpfördelning för verkliga fenomen,</p></li>
<li><p>Beräkna sannolikheter från en antagen fördelning,</p></li>
<li><p>Simulera fenomen med en antagen fördelning,</p></li>
<li><p>Använda slumptal för att utforska teoretiska resultat från sannolikhetsläran.</p></li>
</ul>
<div id="repetition-från-datorövning-2" class="section level2 hasAnchor" number="3.1">
<h2><span class="header-section-number">3.1</span> Repetition från datorövning 2<a href="slumpvariabler.html#repetition-från-datorövning-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>När man startar en ny R-session bör man ladda de paket man vet kommer behövas med <code>library()</code>. Om paket inte finns installerade måste man först köra <code>install.packages()</code>.</p>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb181-1"><a href="slumpvariabler.html#cb181-1" tabindex="-1"></a><span class="co"># install.packages(&quot;tidyverse&quot;)</span></span>
<span id="cb181-2"><a href="slumpvariabler.html#cb181-2" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code></pre></div>
<p>I datorövning 2 tittade vi på hur insamlade variabler kan sammanfattas med lägesmått och spridningsmått. Ett enkelt sätt att ta fram dem är att använda <code>summarise()</code> och ange de mått och variabler man vill använda. Vi hade uppe ett exempel på data från Gapminder som vi importerade från en excel-fil. För nu kan vi dock hämta datan från paketet <code>gapminder</code>.</p>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb182-1"><a href="slumpvariabler.html#cb182-1" tabindex="-1"></a><span class="co"># install.packages(&quot;gapminder&quot;)</span></span>
<span id="cb182-2"><a href="slumpvariabler.html#cb182-2" tabindex="-1"></a><span class="fu">library</span>(gapminder)</span>
<span id="cb182-3"><a href="slumpvariabler.html#cb182-3" tabindex="-1"></a></span>
<span id="cb182-4"><a href="slumpvariabler.html#cb182-4" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span> </span>
<span id="cb182-5"><a href="slumpvariabler.html#cb182-5" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2007</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb182-6"><a href="slumpvariabler.html#cb182-6" tabindex="-1"></a>  <span class="fu">group_by</span>(continent) <span class="sc">%&gt;%</span> </span>
<span id="cb182-7"><a href="slumpvariabler.html#cb182-7" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="st">`</span><span class="at">Livslängd, medel</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">mean</span>(lifeExp),</span>
<span id="cb182-8"><a href="slumpvariabler.html#cb182-8" tabindex="-1"></a>            <span class="st">`</span><span class="at">Befolkning, median</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">median</span>(pop),</span>
<span id="cb182-9"><a href="slumpvariabler.html#cb182-9" tabindex="-1"></a>            <span class="st">`</span><span class="at">Bnp per capita, standardavvikelse</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sd</span>(gdpPercap))</span></code></pre></div>
<pre><code>## # A tibble: 5 × 4
##   continent `Livslängd, medel` `Befolkning, median` Bnp per capita, standardav…¹
##   &lt;chr&gt;                  &lt;dbl&gt;                &lt;dbl&gt;                        &lt;dbl&gt;
## 1 Africa                  54.8            10093310.                        3618.
## 2 Americas                73.6             9319622                         9713.
## 3 Asia                    70.7            24821286                        14155.
## 4 Europe                  77.6             9493598                        11800.
## 5 Oceania                 80.7            12274974.                        6541.
## # ℹ abbreviated name: ¹​`Bnp per capita, standardavvikelse`</code></pre>
<p>Beskrivande mått sammanfattas ofta i någon enkel vetenskaplig graf. Två vanliga val är lådagrammet, som illustrerar kvartiler och möjliga extremvärden, och stapeldiagrammet med felstaplar. Vi ger först ett exempel på ett lådagram över livslängd per kontinent uppdelat efter år.</p>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb184-1"><a href="slumpvariabler.html#cb184-1" tabindex="-1"></a><span class="fu">ggplot</span>(gapminder, <span class="fu">aes</span>(lifeExp, continent, <span class="at">fill =</span> continent)) <span class="sc">+</span></span>
<span id="cb184-2"><a href="slumpvariabler.html#cb184-2" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb184-3"><a href="slumpvariabler.html#cb184-3" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> year)</span></code></pre></div>
<p><img src="R-anvisningar_files/figure-html/fig3_gm_boxplot-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Därefter ett exempel på ett stapeldiagram med felstaplar för samma data. Felstapeln ges av standardavvikelsen.</p>
<div class="sourceCode" id="cb185"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb185-1"><a href="slumpvariabler.html#cb185-1" tabindex="-1"></a>dat_sum <span class="ot">&lt;-</span> gapminder <span class="sc">%&gt;%</span> </span>
<span id="cb185-2"><a href="slumpvariabler.html#cb185-2" tabindex="-1"></a>  <span class="fu">group_by</span>(continent, year) <span class="sc">%&gt;%</span> </span>
<span id="cb185-3"><a href="slumpvariabler.html#cb185-3" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Mean =</span> <span class="fu">mean</span>(lifeExp),</span>
<span id="cb185-4"><a href="slumpvariabler.html#cb185-4" tabindex="-1"></a>            <span class="at">SD =</span> <span class="fu">sd</span>(lifeExp))</span>
<span id="cb185-5"><a href="slumpvariabler.html#cb185-5" tabindex="-1"></a>dat_sum</span></code></pre></div>
<pre><code>## # A tibble: 60 × 4
## # Groups:   continent [5]
##    continent  year  Mean    SD
##    &lt;chr&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1 Africa     1952  39.1  5.15
##  2 Africa     1957  41.3  5.62
##  3 Africa     1962  43.3  5.88
##  4 Africa     1967  45.3  6.08
##  5 Africa     1972  47.5  6.42
##  6 Africa     1977  49.6  6.81
##  7 Africa     1982  51.6  7.38
##  8 Africa     1987  53.3  7.86
##  9 Africa     1992  53.6  9.46
## 10 Africa     1997  53.6  9.10
## # ℹ 50 more rows</code></pre>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb187-1"><a href="slumpvariabler.html#cb187-1" tabindex="-1"></a><span class="fu">ggplot</span>(dat_sum, <span class="fu">aes</span>(continent, Mean, <span class="at">fill =</span> continent)) <span class="sc">+</span></span>
<span id="cb187-2"><a href="slumpvariabler.html#cb187-2" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb187-3"><a href="slumpvariabler.html#cb187-3" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> Mean <span class="sc">-</span> SD, <span class="at">ymax =</span> Mean <span class="sc">+</span> SD), <span class="at">width =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb187-4"><a href="slumpvariabler.html#cb187-4" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> year)</span></code></pre></div>
<p><img src="R-anvisningar_files/figure-html/fig3_gm_bar-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="diskreta-fördelningar-i-allmänhet" class="section level2 hasAnchor" number="3.2">
<h2><span class="header-section-number">3.2</span> Diskreta fördelningar i allmänhet<a href="slumpvariabler.html#diskreta-fördelningar-i-allmänhet" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>En diskret slumpvariabel kan bara anta specifika värden på tallinjen. Det absolut vanligaste fallet är när utfallen är heltal. Tärningskastet med en sex-sidig tärning är ett exempel på en diskret variabel: utfallet är något av 1, 2, 3, 4, 5 och 6. Låt oss börja med att definera en diskret slumpvariabel med tärningskastet som exempel.</p>
<p>Ett kast med en 6-sidig tärning har sex möjliga utfall och (för en balanserad tärning) samma sannolikhet för varje utfall. Eftersom summan av sannolikheter ska bli ett måste sannolikheten för ett specifik utfall vara en sjättedel. Vi kan kodifiera slumpvariabeln i en tabell över utfall och sannolikhet.</p>
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb188-1"><a href="slumpvariabler.html#cb188-1" tabindex="-1"></a>dat_dice6 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>),</span>
<span id="cb188-2"><a href="slumpvariabler.html#cb188-2" tabindex="-1"></a>                        <span class="at">p =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">6</span>)</span>
<span id="cb188-3"><a href="slumpvariabler.html#cb188-3" tabindex="-1"></a>dat_dice6</span></code></pre></div>
<pre><code>##   x         p
## 1 1 0.1666667
## 2 2 0.1666667
## 3 3 0.1666667
## 4 4 0.1666667
## 5 5 0.1666667
## 6 6 0.1666667</code></pre>
<p>En diskret slumpvariabel illustreras ofta med ett stapeldiagram.</p>
<div class="sourceCode" id="cb190"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb190-1"><a href="slumpvariabler.html#cb190-1" tabindex="-1"></a><span class="fu">ggplot</span>(dat_dice6, <span class="fu">aes</span>(x, p)) <span class="sc">+</span> <span class="fu">geom_col</span>()</span></code></pre></div>
<p><img src="R-anvisningar_files/figure-html/unnamed-chunk-125-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="exercise">
<p><span id="exr:unlabeled-div-61" class="exercise"><strong>Uppgift 3.1  (En annan tärning) </strong></span>Ta fram en tärning som <em>inte</em> har sex sidor. Om du saknar en sådan tärning, fråga lämplig person om du kan få en. Behåll tärningen, då den kan återkomma vid en senare datorövning. Följ exemplet ovan för att kodifiera din tärning som en slumpvariabel. Utfallen <code>x</code> är de möjliga resultaten av att kasta tärningen och sannolikheten <code>p</code> är sannolikheten för varje utfall. Antag att tärningen är balanserad och att alla utfall därför är lika troliga. Ett bra namn på det nya objektet kan vara <code>dat_diceN</code> där N anger antalet sidor på tärningen, t.ex. <code>dat_dice20</code> för en 20-sidig tärning.</p>
</div>
<p>Under tidigare datorövningar såg vi hur man kan beräkna medelvärde och varians från ett stickprov. De måtten kan också beräknas på en teoretisk slumpvariabel. Den här kopplingen mellan beräkningar på ett stickprov och teoretiska egenskaper hos en slumpvariabel är väldigt central inom statistiken, eftersom vårt mål är att koppla verklig data till teoretiska modeller.</p>
<p>För en diskret slumpvariabel ges medelvärdet (som då också kallas <em>populationsmedelvärde</em>, eller vanligare <em>väntevärde</em>) av summan av utfallen gånger sannolikheterna. Vi säger att utfallen vägs med sannolikheterna. För vår tärning kan vi räkna ut det genom att multiplicera utfall och sannolikhet i ett <code>mutate()</code> steg och sedan summera.</p>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb191-1"><a href="slumpvariabler.html#cb191-1" tabindex="-1"></a>dat_dice6 <span class="sc">%&gt;%</span> </span>
<span id="cb191-2"><a href="slumpvariabler.html#cb191-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">x_times_p =</span> x <span class="sc">*</span> p) <span class="sc">%&gt;%</span> </span>
<span id="cb191-3"><a href="slumpvariabler.html#cb191-3" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Expected_value =</span> <span class="fu">sum</span>(x_times_p))</span></code></pre></div>
<pre><code>##   Expected_value
## 1            3.5</code></pre>
<p>Notera att medelvärdet inte behöver vara ett möjligt utfall.</p>
<div class="exercise">
<p><span id="exr:unlabeled-div-62" class="exercise"><strong>Uppgift 3.2  (Medelvärde för din tärning) </strong></span>Upprepa beräkningen ovan, denna gång med den slumpvariabel du kodifierade i den tidigare uppgiften.</p>
</div>
<p>Beräkningen av en teoretisk varians (som vi kan kalla <em>populationsvarians</em>) är lite komplicerad. Stegen ges av</p>
<ol style="list-style-type: decimal">
<li>dra ifrån medelvärdet från utfallen,</li>
<li>kvadrera differenserna,</li>
<li>multiplicera kvadraterna med sannolikheterna,</li>
<li>summera produkterna.</li>
</ol>
<p>För den 6-sidiga tärningen får vi beräkningen nedan. Precis som i fallet med faktiskt data ges standardavvikelsen av roten ur variansen.</p>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb193-1"><a href="slumpvariabler.html#cb193-1" tabindex="-1"></a>dat_dice6 <span class="sc">%&gt;%</span> </span>
<span id="cb193-2"><a href="slumpvariabler.html#cb193-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">mean =</span> <span class="fu">sum</span>(x <span class="sc">*</span> p)) <span class="sc">%&gt;%</span> </span>
<span id="cb193-3"><a href="slumpvariabler.html#cb193-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">differenser =</span> x <span class="sc">-</span> mean,</span>
<span id="cb193-4"><a href="slumpvariabler.html#cb193-4" tabindex="-1"></a>         <span class="at">kvadrater =</span> differenser<span class="sc">^</span><span class="dv">2</span>,</span>
<span id="cb193-5"><a href="slumpvariabler.html#cb193-5" tabindex="-1"></a>         <span class="at">produkter =</span> kvadrater <span class="sc">*</span> p) <span class="sc">%&gt;%</span> </span>
<span id="cb193-6"><a href="slumpvariabler.html#cb193-6" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">varians =</span> <span class="fu">sum</span>(produkter),</span>
<span id="cb193-7"><a href="slumpvariabler.html#cb193-7" tabindex="-1"></a>            <span class="at">standardavvikelse =</span> <span class="fu">sqrt</span>(varians))</span></code></pre></div>
<pre><code>##    varians standardavvikelse
## 1 2.916667          1.707825</code></pre>
<div class="exercise">
<p><span id="exr:unlabeled-div-63" class="exercise"><strong>Uppgift 3.3  (Varians för din tärning) </strong></span>Upprepa beräkningen ovan, denna gång med den slumpvariabel du kodifierade i den tidigare uppgiften.</p>
</div>
<p>Vår modell för tärningskastet säger att en serie tärningskast ska ha ett visst medelvärde och varians. Låt oss nu testa det genom att kasta tärning.</p>
<div class="exercise">
<p><span id="exr:unlabeled-div-64" class="exercise"><strong>Uppgift 3.4  (Kasta tärningen) </strong></span>Kasta din tärning 20 gånger. Gärna på en mjuk yta. Skriv in utfallen i koden nedan och beräkna medelvärde och varians.</p>
<div class="sourceCode" id="cb195"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb195-1"><a href="slumpvariabler.html#cb195-1" tabindex="-1"></a>utfall <span class="ot">&lt;-</span> <span class="fu">c</span>(_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_)</span>
<span id="cb195-2"><a href="slumpvariabler.html#cb195-2" tabindex="-1"></a><span class="fu">mean</span>(utfall)</span>
<span id="cb195-3"><a href="slumpvariabler.html#cb195-3" tabindex="-1"></a><span class="fu">var</span>(utfall)</span>
<span id="cb195-4"><a href="slumpvariabler.html#cb195-4" tabindex="-1"></a><span class="fu">sd</span>(utfall)</span></code></pre></div>
<p>Ligger medelvärde och varians från stickprovet nära de teoretiska beräkningarna?</p>
</div>
<p>R kommer också med en rad funktioner för att simulera data. För kontinuerlig data kan man använda funktioner <code>sample()</code> som drar ett valfritt stort urval ur en serie möjlig utfall. Följande kod drar tiotusen slumputfall från en 6-sidig tärning, och beräknar medelvärde och varians.</p>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb196-1"><a href="slumpvariabler.html#cb196-1" tabindex="-1"></a>slumputfall <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="at">x =</span> dat_dice6<span class="sc">$</span>x, <span class="at">size =</span> <span class="dv">10000</span>, <span class="at">replace =</span> T)</span>
<span id="cb196-2"><a href="slumpvariabler.html#cb196-2" tabindex="-1"></a></span>
<span id="cb196-3"><a href="slumpvariabler.html#cb196-3" tabindex="-1"></a><span class="fu">mean</span>(slumputfall)</span></code></pre></div>
<pre><code>## [1] 3.5151</code></pre>
<div class="sourceCode" id="cb198"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb198-1"><a href="slumpvariabler.html#cb198-1" tabindex="-1"></a><span class="fu">var</span>(slumputfall)</span></code></pre></div>
<pre><code>## [1] 2.927065</code></pre>
<div class="exercise">
<p><span id="exr:unlabeled-div-65" class="exercise"><strong>Uppgift 3.5  (Simulera tärningen) </strong></span>Använd <code>sample()</code> för att dra tiotusen observationer från din egen tärning. Beräkna medelvärde och varians från det stickprovet. Är utfallen nära de teoretiska beräkningarna av populationsmedelvärde och -varians?</p>
</div>
</div>
<div id="särskilda-diskreta-fördelningar-binomialfördelning" class="section level2 hasAnchor" number="3.3">
<h2><span class="header-section-number">3.3</span> Särskilda diskreta fördelningar: binomialfördelning<a href="slumpvariabler.html#särskilda-diskreta-fördelningar-binomialfördelning" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Vi såg i tärningsexemplet hur en slumpvariabel kan beskrivas med dess sannolikhetsfördelning - variabeln förklaras helt av de möjliga utfallen och sannolikheten för varje utfall. Man kan dock ofta beskriva en slumpvariabel i mindre direkta termer. Ett tärningskast med en 6-sidig tärning kan beskrivas som <em>utfall från 1 till 6 med varje utfall lika sannolikt</em> och ett tärningskast med en 20-sidig tärning kan beskrivas som <em>utfall från 1 till 20 med varje utfall lika sannolikt</em>. Slumpvariablerna kan alltså beskrivas på ett tydligt sätt utifrån den bakomliggande processen. Den här typen av variabler är ofta <em>parametriserade</em> - det finns någon aspekt av processen som beskrivs med en bestämd siffra (6 respektive 20 för de bägge tärningskasten).</p>
<p>Ett vanligt exempel på en sådan <em>parametriserad</em> fördelning är en binomialfördelning. En binomialfördelning uppstår när man har upprepningar av en binär händelse (en händelse som antingen inträffar eller inte inträffar) och räknar antalet <em>positiva</em> utfall (positiva i klinisk mening som något utfall man är intresserad av). I en binomialfördelning ges antalet upprepningar av en parameter <em>n</em> och sannolikheten för ett positivt utfall i en händelse av en parameter <em>p</em>.</p>
<p>Som exempel kan vi ta ett myntkast. Om man singlar ett balanserat mynt tio gånger kommer antalet krona (vårt positiva utfall) följa en binomialfördelning där n ges av 10 och p av 0.5. I R kan sannolikheter från en binomialfördelning tas fram med <code>dbinom()</code>. Sannolikheten för tre krona ges till exempel av</p>
<div class="sourceCode" id="cb200"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb200-1"><a href="slumpvariabler.html#cb200-1" tabindex="-1"></a><span class="fu">dbinom</span>(<span class="dv">3</span>, <span class="at">size =</span> <span class="dv">10</span>, <span class="at">prob =</span> <span class="fl">0.5</span>)</span></code></pre></div>
<pre><code>## [1] 0.1171875</code></pre>
<p>Om vi vill illustrera en binomalfördelning kan vi ta fram sannolikheterna för varje utfall och göra ett stapeldiagram.</p>
<div class="sourceCode" id="cb202"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb202-1"><a href="slumpvariabler.html#cb202-1" tabindex="-1"></a>dat_bin <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb202-2"><a href="slumpvariabler.html#cb202-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">p =</span> <span class="fu">dbinom</span>(x, <span class="at">size =</span> <span class="dv">10</span>, <span class="at">prob =</span> <span class="fl">0.5</span>))</span>
<span id="cb202-3"><a href="slumpvariabler.html#cb202-3" tabindex="-1"></a></span>
<span id="cb202-4"><a href="slumpvariabler.html#cb202-4" tabindex="-1"></a><span class="fu">ggplot</span>(dat_bin, <span class="fu">aes</span>(x, p)) <span class="sc">+</span> <span class="fu">geom_col</span>()</span></code></pre></div>
<p><img src="R-anvisningar_files/figure-html/unnamed-chunk-131-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="exercise">
<p><span id="exr:unlabeled-div-66" class="exercise"><strong>Uppgift 3.6  (Binomialfördelning för tärningen) </strong></span>Ta tärningen från tidigare uppgift. Om man kastar tärningen tjugo gånger, vad är fördelningen för antalet gånger man får tärningens lägsta utfall? (Till exempel, vad är fördelningen för antalet ettor vid tjugo kast med en sexsidig tärning?) Fyll i stycket nedan för att beräkna sannolikheterna i den fördelningen och illustrera med ett stapeldiagram.</p>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb203-1"><a href="slumpvariabler.html#cb203-1" tabindex="-1"></a>dat_bin <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">20</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb203-2"><a href="slumpvariabler.html#cb203-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">p =</span> <span class="fu">dbinom</span>(x, <span class="at">size =</span> <span class="dv">20</span>, <span class="at">prob =</span> ___))</span>
<span id="cb203-3"><a href="slumpvariabler.html#cb203-3" tabindex="-1"></a></span>
<span id="cb203-4"><a href="slumpvariabler.html#cb203-4" tabindex="-1"></a><span class="fu">ggplot</span>(dat_bin, <span class="fu">aes</span>(x, p)) <span class="sc">+</span> <span class="fu">geom_col</span>()</span></code></pre></div>
</div>
<div class="exercise">
<p><span id="exr:unlabeled-div-67" class="exercise"><strong>Uppgift 3.7  (Sannolikheter i binomialen) </strong></span>I den fördelning du beräknade i uppgiften ovan. Vad är sannolikheten att få exakt tre positiva utfall? (Ledning: för en sexsidig tärning skulle det ges av <code>dbinom(3, size = 20, prob = 1/6))</code>.)</p>
</div>
<p>Utöver sannolikhetsfunktionen (som ger sannolikheten för varje utfall) används ofta också fördelningsfunktionen (som för varje utfall ger sannolikheten att ligga exakt på eller under ett specifikt värde). Fördelningsfunktionen används vid sannolikhetsberäkningar, t.ex. är de tabeller för fördelningar man ofta ser i slutet av statistikböcker på fördelningsformen.</p>
<p>I R beräknas fördelningsfunktionen med <code>pbinom()</code>. För fallet med tio slantsinglingar kan man ta</p>
<div class="sourceCode" id="cb204"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb204-1"><a href="slumpvariabler.html#cb204-1" tabindex="-1"></a>dat_bin <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb204-2"><a href="slumpvariabler.html#cb204-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">p =</span> <span class="fu">dbinom</span>(x, <span class="at">size =</span> <span class="dv">10</span>, <span class="at">prob =</span> <span class="fl">0.5</span>),</span>
<span id="cb204-3"><a href="slumpvariabler.html#cb204-3" tabindex="-1"></a>         <span class="at">P =</span> <span class="fu">pbinom</span>(x, <span class="at">size =</span> <span class="dv">10</span>, <span class="at">prob =</span> <span class="fl">0.5</span>))</span>
<span id="cb204-4"><a href="slumpvariabler.html#cb204-4" tabindex="-1"></a>dat_bin</span></code></pre></div>
<pre><code>##     x            p            P
## 1   0 0.0009765625 0.0009765625
## 2   1 0.0097656250 0.0107421875
## 3   2 0.0439453125 0.0546875000
## 4   3 0.1171875000 0.1718750000
## 5   4 0.2050781250 0.3769531250
## 6   5 0.2460937500 0.6230468750
## 7   6 0.2050781250 0.8281250000
## 8   7 0.1171875000 0.9453125000
## 9   8 0.0439453125 0.9892578125
## 10  9 0.0097656250 0.9990234375
## 11 10 0.0009765625 1.0000000000</code></pre>
<p>Fördelningsfunktionen ges av att summera sannolikhetsfunktionen uppifrån.</p>
<div class="exercise">
<p><span id="exr:unlabeled-div-68" class="exercise"><strong>Uppgift 3.8  (Fördelningsfunktion i binomialen) </strong></span>Använd binomialfördelningen från den tidigare uppgiften till att beräkna sannolikheten att få <em>tre eller färre</em> positiva utfall.</p>
</div>
<p>Vi kan använda ett logiskt uttryck för att illustrera sannolikheter i stapeldiagrammet. Om vi vill beräkna och illustrera sannolikheten för sju eller färre positiva utfall i exemplet med mynten kan vi använda följande.</p>
<div class="sourceCode" id="cb206"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb206-1"><a href="slumpvariabler.html#cb206-1" tabindex="-1"></a><span class="fu">pbinom</span>(<span class="dv">7</span>, <span class="at">size =</span> <span class="dv">10</span>, <span class="at">prob =</span> <span class="fl">0.5</span>)</span></code></pre></div>
<pre><code>## [1] 0.9453125</code></pre>
<div class="sourceCode" id="cb208"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb208-1"><a href="slumpvariabler.html#cb208-1" tabindex="-1"></a>dat_bin <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb208-2"><a href="slumpvariabler.html#cb208-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">p =</span> <span class="fu">dbinom</span>(x, <span class="at">size =</span> <span class="dv">10</span>, <span class="at">prob =</span> <span class="fl">0.5</span>),</span>
<span id="cb208-3"><a href="slumpvariabler.html#cb208-3" tabindex="-1"></a>         <span class="at">P =</span> <span class="fu">pbinom</span>(x, <span class="at">size =</span> <span class="dv">10</span>, <span class="at">prob =</span> <span class="fl">0.5</span>))</span>
<span id="cb208-4"><a href="slumpvariabler.html#cb208-4" tabindex="-1"></a></span>
<span id="cb208-5"><a href="slumpvariabler.html#cb208-5" tabindex="-1"></a><span class="fu">ggplot</span>(dat_bin, <span class="fu">aes</span>(x, p, <span class="at">fill =</span> x <span class="sc">&lt;=</span> <span class="dv">7</span>)) <span class="sc">+</span></span>
<span id="cb208-6"><a href="slumpvariabler.html#cb208-6" tabindex="-1"></a>  <span class="fu">geom_col</span>()</span></code></pre></div>
<p><img src="R-anvisningar_files/figure-html/unnamed-chunk-134-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Den blå ytan motsvarar sannolikheten att få sju eller färre krona. Den sannolikheten kan beräknas till 0.945.</p>
<div class="exercise">
<p><span id="exr:unlabeled-div-69" class="exercise"><strong>Uppgift 3.9  (Illustration av sannolikheten) </strong></span>För en sexsidig tärning illustrerar följande sannolikheten att få tre eller färre sexor vid tjugo kast.</p>
<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb209-1"><a href="slumpvariabler.html#cb209-1" tabindex="-1"></a><span class="fu">pbinom</span>(<span class="dv">3</span>, <span class="at">size =</span> <span class="dv">20</span>, <span class="at">prob =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">6</span>)</span></code></pre></div>
<pre><code>## [1] 0.5665456</code></pre>
<div class="sourceCode" id="cb211"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb211-1"><a href="slumpvariabler.html#cb211-1" tabindex="-1"></a>dat_bin <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">20</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb211-2"><a href="slumpvariabler.html#cb211-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">p =</span> <span class="fu">dbinom</span>(x, <span class="at">size =</span> <span class="dv">20</span>, <span class="at">prob =</span> <span class="dv">1</span> <span class="sc">/</span> <span class="dv">6</span>))</span>
<span id="cb211-3"><a href="slumpvariabler.html#cb211-3" tabindex="-1"></a></span>
<span id="cb211-4"><a href="slumpvariabler.html#cb211-4" tabindex="-1"></a><span class="fu">ggplot</span>(dat_bin, <span class="fu">aes</span>(x, p, <span class="at">fill =</span> x <span class="sc">&lt;=</span> <span class="dv">3</span>)) <span class="sc">+</span></span>
<span id="cb211-5"><a href="slumpvariabler.html#cb211-5" tabindex="-1"></a>  <span class="fu">geom_col</span>()</span></code></pre></div>
<p><img src="R-anvisningar_files/figure-html/unnamed-chunk-135-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Gör lämpliga ändringar i kodstycket ovan för att illustrera sannolikheten att få exakt tre positiva utfall i exemplet med tärningskastet.</p>
</div>
<div class="exercise">
<p><span id="exr:unlabeled-div-70" class="exercise"><strong>Uppgift 3.10  (Teori och verklighet) </strong></span>I en tidigare uppgift kastade du tärningen tjugo gånger. Hur många gånger fick du det lägsta möjliga utfallet på tärningen (t.ex. en etta på en vanlig sex-sidig tärning).</p>
</div>
<p>I det första exemplet med tärningen kunde vi beräkna väntevärde och varians med de allmäna formlerna. För parametriserade fördelningar som binomialfördelningen finns ofta enklare formler som helt beror på parametrarna. I en binomial ges populationsmedelvärdet av antalet upprepningar gånger sannolikheten (n gånger p) och variansen av antalet upprepningar gånger sannolikheten gånger ett-minus-sannolikheten (n gånger p gånger (1 - p)). För myntkastet (n = 10 och p = 0.5) ges medelvärdet av 5 och variansen av 2.5.</p>
<div class="exercise">
<p><span id="exr:unlabeled-div-71" class="exercise"><strong>Uppgift 3.11  (Medelvärde och varians i binomialen) </strong></span>Beräkna medelvärde och varians för antalet ettor om man kastar en sex-sidig tärning tjugo gånger.</p>
</div>
</div>
<div id="särskilda-diskreta-fördelningar-poissonfördelning" class="section level2 hasAnchor" number="3.4">
<h2><span class="header-section-number">3.4</span> Särskilda diskreta fördelningar: poissonfördelning<a href="slumpvariabler.html#särskilda-diskreta-fördelningar-poissonfördelning" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>En poissonfördelning är en vanlig sannolikhetsfördelning för antalsdata (alltså data som antar positiva heltal som 0, 1, 2, 3 och så vidare). Poissonfördelningen har en nära koppling till binomialfördelningen.
Om man tittar på binomialfördelningar med stort antal upprepningar och en låg sannolikhet för ett positivt utfall kan man observera att intressant fenomen: binomialfördelningar med samma medelvärde är <em>väldigt</em> lika. Ta som exempel en binomial med n = 5000 och p = 0.0006 och en annan binomialfördelning med n = 400 och p = 0.0075. Bägge fördelningarna har medelvärde 3 (ta n gånger p för att bekräfta det). Vi kan beräkna sannolikhetsfördelningen med <code>dbinom()</code>.</p>
<div class="sourceCode" id="cb212"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb212-1"><a href="slumpvariabler.html#cb212-1" tabindex="-1"></a>dat_two_bin <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">30</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb212-2"><a href="slumpvariabler.html#cb212-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">binom1 =</span> <span class="fu">dbinom</span>(x, <span class="at">size =</span> <span class="dv">5000</span>, <span class="at">p =</span> <span class="fl">0.0006</span>),</span>
<span id="cb212-3"><a href="slumpvariabler.html#cb212-3" tabindex="-1"></a>         <span class="at">binom2 =</span> <span class="fu">dbinom</span>(x, <span class="at">size =</span> <span class="dv">400</span>, <span class="at">p =</span> <span class="fl">0.0075</span>),</span>
<span id="cb212-4"><a href="slumpvariabler.html#cb212-4" tabindex="-1"></a>         <span class="at">Differens =</span> binom1 <span class="sc">-</span> binom2)</span>
<span id="cb212-5"><a href="slumpvariabler.html#cb212-5" tabindex="-1"></a>dat_two_bin</span></code></pre></div>
<pre><code>##     x       binom1       binom2     Differens
## 1   0 4.974226e-02 4.922732e-02  5.149444e-04
## 2   1 1.493164e-01 1.487979e-01  5.184384e-04
## 3   2 2.240642e-01 2.243213e-01 -2.571164e-04
## 4   3 2.241090e-01 2.248864e-01 -7.773178e-04
## 5   4 1.680818e-01 1.686648e-01 -5.829883e-04
## 6   5 1.008289e-01 1.009440e-01 -1.150660e-04
## 7   6 5.039427e-02 5.021771e-02  1.765560e-04
## 8   7 2.158458e-02 2.135924e-02  2.253344e-04
## 9   8 8.087737e-03 7.929013e-03  1.587236e-04
## 10  9 2.693215e-03 2.609717e-03  8.349753e-05
## 11 10 8.069943e-04 7.710827e-04  3.591159e-05
## 12 11 2.197810e-04 2.065873e-04  1.319374e-05
## 13 12 5.485730e-05 5.060608e-05  4.251211e-06
## 14 13 1.263658e-05 1.141358e-05  1.222996e-06
## 15 14 2.702419e-06 2.384161e-06  3.182579e-07
## 16 15 5.392940e-07 4.636202e-07  7.567378e-08
## 17 16 1.008748e-07 8.430121e-08  1.657358e-08
## 18 17 1.775512e-08 1.438954e-08  3.365583e-09
## 19 18 2.950896e-09 2.313683e-09  6.372131e-10
## 20 19 4.645324e-10 3.515154e-10  1.130169e-10
## 21 20 6.945674e-11 5.060229e-11  1.885446e-11
## 22 21 9.888636e-12 6.919348e-12  2.969288e-12
## 23 22 1.343593e-12 9.007670e-13  4.428260e-13
## 24 23 1.745849e-13 1.118683e-13  6.271657e-14
## 25 24 2.173577e-14 1.327908e-14  8.456687e-15
## 26 25 2.597331e-15 1.509199e-15  1.088131e-15
## 27 26 2.983726e-16 1.644884e-16  1.338842e-16
## 28 27 3.299992e-17 1.721765e-17  1.578227e-17
## 29 28 3.518724e-18 1.733227e-18  1.785497e-18
## 30 29 3.621848e-19 1.680084e-19  1.941763e-19
## 31 30 3.603003e-20 1.570054e-20  2.032949e-20</code></pre>
<p>Vi kan illustrera de två fördelningarna i en graf. Den ena fördelningen illustreras med en linje och den andra som punkter, för att kunna se bägge fördelningarna i en bild.</p>
<div class="sourceCode" id="cb214"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb214-1"><a href="slumpvariabler.html#cb214-1" tabindex="-1"></a><span class="fu">ggplot</span>(dat_two_bin) <span class="sc">+</span></span>
<span id="cb214-2"><a href="slumpvariabler.html#cb214-2" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(x, binom1), <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb214-3"><a href="slumpvariabler.html#cb214-3" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(x, binom2), <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>)</span></code></pre></div>
<p><img src="R-anvisningar_files/figure-html/unnamed-chunk-137-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Punkterna ligger nästan perfekt på linjen. De två binomialfördelningarna har alltså nästan samma sannolikheter, trots att de har helt olika värden för n och p.</p>
<div class="exercise">
<p><span id="exr:unlabeled-div-72" class="exercise"><strong>Uppgift 3.12  (Skilda sannolikheter) </strong></span>Följande kod gör samma sak som exemplet ovan, men nu med n1 och n2 som egna objekt.</p>
<div class="sourceCode" id="cb215"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb215-1"><a href="slumpvariabler.html#cb215-1" tabindex="-1"></a>n1 <span class="ot">&lt;-</span> <span class="dv">5000</span></span>
<span id="cb215-2"><a href="slumpvariabler.html#cb215-2" tabindex="-1"></a>n2 <span class="ot">&lt;-</span> <span class="dv">400</span></span>
<span id="cb215-3"><a href="slumpvariabler.html#cb215-3" tabindex="-1"></a></span>
<span id="cb215-4"><a href="slumpvariabler.html#cb215-4" tabindex="-1"></a>dat_two_bin <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">30</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb215-5"><a href="slumpvariabler.html#cb215-5" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">binom1 =</span> <span class="fu">dbinom</span>(x, <span class="at">size =</span> n1, <span class="at">p =</span> <span class="dv">3</span> <span class="sc">/</span> n1),</span>
<span id="cb215-6"><a href="slumpvariabler.html#cb215-6" tabindex="-1"></a>         <span class="at">binom2 =</span> <span class="fu">dbinom</span>(x, <span class="at">size =</span> n2, <span class="at">p =</span> <span class="dv">3</span> <span class="sc">/</span> n2),</span>
<span id="cb215-7"><a href="slumpvariabler.html#cb215-7" tabindex="-1"></a>         <span class="at">Differens =</span> binom1 <span class="sc">-</span> binom2)</span>
<span id="cb215-8"><a href="slumpvariabler.html#cb215-8" tabindex="-1"></a>dat_two_bin</span>
<span id="cb215-9"><a href="slumpvariabler.html#cb215-9" tabindex="-1"></a></span>
<span id="cb215-10"><a href="slumpvariabler.html#cb215-10" tabindex="-1"></a><span class="fu">ggplot</span>(dat_two_bin) <span class="sc">+</span></span>
<span id="cb215-11"><a href="slumpvariabler.html#cb215-11" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(x, binom1), <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb215-12"><a href="slumpvariabler.html#cb215-12" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(x, binom2), <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>)</span></code></pre></div>
<p>Ändra värdena för <code>n1</code> och <code>n2</code> och gör om grafen. Vad händer när antalet upprepningar blir lägre, t.ex 50 och 20 - ligger punkterna fortfarande över linjen?</p>
</div>
<p>Det här fenomenet - att binomialfördelningar med samma medelvärde, högt n och lågt p ger liknande sannolikheter - är ett uttryck för ett teoretiskt resultat som säger att en binomalfördelning går mot en <em>poissonfördelning</em> när n ökar och p minskar. Det innebär att en poissonfördelning är en lämplig fördelning för händelser som har många upprepningar men låg sannolikhet att inträffa i det enskilda försöket. Typexempel är olika typer av olyckor. Ett av de första historiska exemplet på beräkningar med en poissonfördelning kommer från Preussen under 1800-talet och handlar om soldater som dött i höstoyckor. Där är antalet försök stort (soldater var ofta nära hästar) men sannolikheten låg i varje enskild interaktion.</p>
<p>Poissonfördelningen styrs av en enda parameter, lambda. Parametern lambda är lika med fördelningens medelvärde och varians. Till skillnad från en binomialfördelning, där det högsta möjliga utfall ges av n, har en poissonfördelning inget maxvärde. Man kan i teorin få vilket positivt heltalsutfall som helst.</p>
<p>Vi gör om jämförelse mellan två fördelning, men nu jämför vi med en poissonfördelning med lambda lika med 3.</p>
<div class="sourceCode" id="cb216"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb216-1"><a href="slumpvariabler.html#cb216-1" tabindex="-1"></a>dat_two_dist <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">30</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb216-2"><a href="slumpvariabler.html#cb216-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pois =</span> <span class="fu">dpois</span>(x, <span class="at">lambda =</span> <span class="dv">3</span>),</span>
<span id="cb216-3"><a href="slumpvariabler.html#cb216-3" tabindex="-1"></a>         <span class="at">binom =</span> <span class="fu">dbinom</span>(x, <span class="at">size =</span> <span class="dv">400</span>, <span class="at">p =</span> <span class="fl">0.0075</span>),</span>
<span id="cb216-4"><a href="slumpvariabler.html#cb216-4" tabindex="-1"></a>         <span class="at">Differens =</span> binom <span class="sc">-</span> pois)</span>
<span id="cb216-5"><a href="slumpvariabler.html#cb216-5" tabindex="-1"></a>dat_two_dist</span></code></pre></div>
<pre><code>##     x         pois        binom     Differens
## 1   0 4.978707e-02 4.922732e-02 -5.597505e-04
## 2   1 1.493612e-01 1.487979e-01 -5.632670e-04
## 3   2 2.240418e-01 2.243213e-01  2.795172e-04
## 4   3 2.240418e-01 2.248864e-01  8.445584e-04
## 5   4 1.680314e-01 1.686648e-01  6.334188e-04
## 6   5 1.008188e-01 1.009440e-01  1.251423e-04
## 7   6 5.040941e-02 5.021771e-02 -1.916958e-04
## 8   7 2.160403e-02 2.135924e-02 -2.447891e-04
## 9   8 8.101512e-03 7.929013e-03 -1.724984e-04
## 10  9 2.700504e-03 2.609717e-03 -9.078666e-05
## 11 10 8.101512e-04 7.710827e-04 -3.906847e-05
## 12 11 2.209503e-04 2.065873e-04 -1.436301e-05
## 13 12 5.523758e-05 5.060608e-05 -4.631496e-06
## 14 13 1.274713e-05 1.141358e-05 -1.333555e-06
## 15 14 2.731529e-06 2.384161e-06 -3.473679e-07
## 16 15 5.463057e-07 4.636202e-07 -8.268556e-08
## 17 16 1.024323e-07 8.430121e-08 -1.813111e-08
## 18 17 1.807629e-08 1.438954e-08 -3.686754e-09
## 19 18 3.012715e-09 2.313683e-09 -6.990323e-10
## 20 19 4.756919e-10 3.515154e-10 -1.241765e-10
## 21 20 7.135379e-11 5.060229e-11 -2.075150e-11
## 22 21 1.019340e-11 6.919348e-12 -3.274050e-12
## 23 22 1.390009e-12 9.007670e-13 -4.892419e-13
## 24 23 1.813055e-13 1.118683e-13 -6.943717e-14
## 25 24 2.266319e-14 1.327908e-14 -9.384107e-15
## 26 25 2.719583e-15 1.509199e-15 -1.210383e-15
## 27 26 3.137980e-16 1.644884e-16 -1.493096e-16
## 28 27 3.486644e-17 1.721765e-17 -1.764879e-17
## 29 28 3.735690e-18 1.733227e-18 -2.002463e-18
## 30 29 3.864507e-19 1.680084e-19 -2.184423e-19
## 31 30 3.864507e-20 1.570054e-20 -2.294454e-20</code></pre>
<div class="sourceCode" id="cb218"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb218-1"><a href="slumpvariabler.html#cb218-1" tabindex="-1"></a><span class="fu">ggplot</span>(dat_two_dist) <span class="sc">+</span></span>
<span id="cb218-2"><a href="slumpvariabler.html#cb218-2" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(x, pois), <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb218-3"><a href="slumpvariabler.html#cb218-3" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(x, binom), <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>)</span></code></pre></div>
<p><img src="R-anvisningar_files/figure-html/unnamed-chunk-139-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Den röda linjen är poissonfördelningen och de blå punkterna är en binomialfördelning med n = 400 och p = 0.0075. Fördelningarna är nästan identiska. Notera att fördelningarna har samma medelvärde (då 400 gånger 0.0075 ger 3).</p>
<div class="exercise">
<p><span id="exr:unlabeled-div-73" class="exercise"><strong>Uppgift 3.13  (Skilda sannolikheter) </strong></span>Följande kod gör samma sak som exemplet ovan, men nu med n i binomial som eget objekt.</p>
<div class="sourceCode" id="cb219"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb219-1"><a href="slumpvariabler.html#cb219-1" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">400</span></span>
<span id="cb219-2"><a href="slumpvariabler.html#cb219-2" tabindex="-1"></a></span>
<span id="cb219-3"><a href="slumpvariabler.html#cb219-3" tabindex="-1"></a>dat_two_dist <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">30</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb219-4"><a href="slumpvariabler.html#cb219-4" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pois =</span> <span class="fu">dpois</span>(x, <span class="at">lambda =</span> <span class="dv">3</span>),</span>
<span id="cb219-5"><a href="slumpvariabler.html#cb219-5" tabindex="-1"></a>         <span class="at">binom =</span> <span class="fu">dbinom</span>(x, <span class="at">size =</span> n, <span class="at">p =</span> <span class="dv">3</span> <span class="sc">/</span> n),</span>
<span id="cb219-6"><a href="slumpvariabler.html#cb219-6" tabindex="-1"></a>         <span class="at">Differens =</span> binom <span class="sc">-</span> pois)</span>
<span id="cb219-7"><a href="slumpvariabler.html#cb219-7" tabindex="-1"></a>dat_two_dist</span>
<span id="cb219-8"><a href="slumpvariabler.html#cb219-8" tabindex="-1"></a></span>
<span id="cb219-9"><a href="slumpvariabler.html#cb219-9" tabindex="-1"></a><span class="fu">ggplot</span>(dat_two_dist) <span class="sc">+</span></span>
<span id="cb219-10"><a href="slumpvariabler.html#cb219-10" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(x, pois), <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb219-11"><a href="slumpvariabler.html#cb219-11" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(x, binom), <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>)</span></code></pre></div>
<p>Från statistisk teori tror vi att skillnaden mellan poissonfördelninen och binomialen växer när antalet upprepningar är litet. Vad händer när antalet upprepningar blir lägre, t.ex 50 eller 20 - ligger punkterna fortfarande över linjen? Vad händer om man ändrar medelvärdet (vilket här är tre). Notera att man då måste ändra i poissonfördelning och binomialfördelning eftersom vi vill jämföra fördelningar med samma medelvärde.</p>
</div>
<p>I R kan man beräkna sannolikheter för en poissonfördelning med <code>dpois()</code> och <code>ppois()</code>.</p>
<div class="exercise">
<p><span id="exr:unlabeled-div-74" class="exercise"><strong>Uppgift 3.14  (Sannolikhetsfunktionen för en poisson) </strong></span>Följande ger sannolikheten att få utfall 2 i en poissonfördelning med lambda satt till 4.</p>
<div class="sourceCode" id="cb220"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb220-1"><a href="slumpvariabler.html#cb220-1" tabindex="-1"></a><span class="fu">dpois</span>(<span class="dv">2</span>, <span class="at">lambda =</span> <span class="dv">4</span>)</span></code></pre></div>
<pre><code>## [1] 0.1465251</code></pre>
<p>Gör lämpliga ändringar för att beräkna sannolikheten för exakt 5 i en fördelning med lambda satt till 3.</p>
</div>
<div class="exercise">
<p><span id="exr:unlabeled-div-75" class="exercise"><strong>Uppgift 3.15  (Fördelningsfunktionen för en poisson) </strong></span>Följande ger sannolikheten att få mindre än eller lika med 2 i en poissonfördelning med lambda satt till 4.</p>
<div class="sourceCode" id="cb222"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb222-1"><a href="slumpvariabler.html#cb222-1" tabindex="-1"></a><span class="fu">ppois</span>(<span class="dv">2</span>, <span class="at">lambda =</span> <span class="dv">4</span>)</span></code></pre></div>
<pre><code>## [1] 0.2381033</code></pre>
<p>Gör lämpliga ändringar för att beräkna sannolikheten för <em>mindre än eller lika med 5</em> i en fördelning med lambda satt till 3.
Hur kan man beräkna sannolikheten att få mer än 5 i en fördelning med lambda satt till 3?</p>
</div>
</div>
<div id="kontinuerliga-fördelningar-i-allmänhet" class="section level2 hasAnchor" number="3.5">
<h2><span class="header-section-number">3.5</span> Kontinuerliga fördelningar i allmänhet<a href="slumpvariabler.html#kontinuerliga-fördelningar-i-allmänhet" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>En kontinuerlig fördelning kan anta vilka värden som helst på hela tallinjen eller i något intervall på tallinjen. Ett enkelt exempel på en kontinuerlig slumpvariabel kan vara att stoppa ett stoppur slumpmässigt och titta på decimaldelen. Det kommer ge något värde mellan 0 och 1. (Stoppuret kommer naturligtvis avrunda värdet, så man får tänka sig ett magiskt stoppur med oändligt antal decimaler.) Till skillnad från en diskret slumpvariabel, som kan beskrivas med utfallen och dess sannolikheter, måste en kontinuerlig variabel förklaras med en matematisk funktion, en så kallad <em>täthetsfunktion</em>. Detta beror på att enskilda utfall alltid har sannolikhet noll för en kontinuerlig fördelning: om man har oändligt antal decimaler är det som exempel sannolikhet noll att få exakt 0.345000… som decimaler på ett stoppur.</p>
<p>Den absolut vanligaste kontinuerliga fördelningen är en <em>normalfördelning</em>.</p>
</div>
<div id="särskilda-kontinuerliga-fördelningar-normalfördelningen" class="section level2 hasAnchor" number="3.6">
<h2><span class="header-section-number">3.6</span> Särskilda kontinuerliga fördelningar: normalfördelningen<a href="slumpvariabler.html#särskilda-kontinuerliga-fördelningar-normalfördelningen" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>En normalfördelning är en kontinuerlig fördelning some kan anta värden över hela tallinjen och beror på två parametrar: mu som styr var fördelningens är centrerad, och sigma som styr hur utspridd fördelningen är.
En normalfördelning har en karaktäristisk <em>klockform</em>. Vi illustreras två normalfördelningar med hjälp av geomet <code>geom_function()</code> i en ggplot.</p>
<div class="sourceCode" id="cb224"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb224-1"><a href="slumpvariabler.html#cb224-1" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb224-2"><a href="slumpvariabler.html#cb224-2" tabindex="-1"></a>  <span class="fu">geom_function</span>(<span class="at">fun =</span> dnorm, <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> <span class="dv">5</span>, <span class="at">sd =</span> <span class="dv">2</span>), <span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb224-3"><a href="slumpvariabler.html#cb224-3" tabindex="-1"></a>  <span class="fu">geom_function</span>(<span class="at">fun =</span> dnorm, <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> <span class="dv">3</span>, <span class="at">sd =</span> <span class="dv">1</span>), <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb224-4"><a href="slumpvariabler.html#cb224-4" tabindex="-1"></a>  <span class="fu">geom_function</span>(<span class="at">fun =</span> dnorm, <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> <span class="dv">5</span>, <span class="at">sd =</span> <span class="dv">1</span>), <span class="at">color =</span> <span class="st">&quot;green3&quot;</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb224-5"><a href="slumpvariabler.html#cb224-5" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="dv">10</span>)</span></code></pre></div>
<p><img src="R-anvisningar_files/figure-html/unnamed-chunk-143-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Den gröna och röda kurvan har samma medelvärde mu men skilda standardavvikelser sigma. Den blå och gröna kurvan har skilda medelvärden mu men samma standardavvikelse sigma.</p>
<div class="exercise">
<p><span id="exr:unlabeled-div-76" class="exercise"><strong>Uppgift 3.16  (Normalfördelningar) </strong></span>Gör lämpliga ändringar i stycken ovan för att illustrera två normalfördelningar: en med medelvärde 0 och standardavvikelse 1 och en med medelvärde 1 och standardavvikelse 2. Kan du utifrån kurvorna säga vilken av de två fördelningarna som ger störst sannolikhet att få ett utfall under minus två?</p>
</div>
<p>Kurvorna illustrerar täthetsfunktionen. I en kontinuerlig fördelning har täthetsfunktionen ingen tolkning i termer av sannolikheter. För att kunna förstå i normalfördelning behöver vi titta på fördelningsfunktionen. Kom ihåg från det diskreta fallet att fördelningsfunktionen anger sannolikheten för exakt lika eller under ett givet värde. Samma sak gäller för en kontinuerlig variabel. Fördelningsfunktionen värde ges av <code>pnorm()</code>. Om vi vill beräkna sannolikheten att ligga under 1 i en normalfördelning med medelvärde 2 och standardavvikelse 3 tar vi</p>
<div class="sourceCode" id="cb225"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb225-1"><a href="slumpvariabler.html#cb225-1" tabindex="-1"></a><span class="fu">pnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span> <span class="dv">2</span>, <span class="at">sd =</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code>## [1] 0.3694413</code></pre>
<p>Vi kan ta fram en illustration med följande kod. Detaljer spelar mindre roll här, men gör gärna några ändringar i <code>x_value</code>, <code>mu</code> och <code>sigma</code>för att se hur grafen ändras. Om paketet <code>patchwork</code> inte är installerat, kör raden som här är utkommenterad med <code>#</code>.</p>
<div class="sourceCode" id="cb227"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb227-1"><a href="slumpvariabler.html#cb227-1" tabindex="-1"></a>x_value <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb227-2"><a href="slumpvariabler.html#cb227-2" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb227-3"><a href="slumpvariabler.html#cb227-3" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb227-4"><a href="slumpvariabler.html#cb227-4" tabindex="-1"></a></span>
<span id="cb227-5"><a href="slumpvariabler.html#cb227-5" tabindex="-1"></a>P_value <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(x_value, <span class="at">mean =</span> mu, <span class="at">sd =</span> sigma)</span>
<span id="cb227-6"><a href="slumpvariabler.html#cb227-6" tabindex="-1"></a>P_value</span></code></pre></div>
<pre><code>## [1] 0.3694413</code></pre>
<div class="sourceCode" id="cb229"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb229-1"><a href="slumpvariabler.html#cb229-1" tabindex="-1"></a>dat_norm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="at">from =</span> mu <span class="sc">-</span> <span class="dv">4</span> <span class="sc">*</span> sigma, <span class="at">to =</span> mu <span class="sc">+</span> <span class="dv">4</span> <span class="sc">*</span> sigma, <span class="fl">0.1</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb229-2"><a href="slumpvariabler.html#cb229-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">p =</span> <span class="fu">dnorm</span>(x, <span class="at">mean =</span> mu, <span class="at">sd =</span> sigma),</span>
<span id="cb229-3"><a href="slumpvariabler.html#cb229-3" tabindex="-1"></a>         <span class="at">P =</span> <span class="fu">pnorm</span>(x, <span class="at">mean =</span> mu, <span class="at">sd =</span> sigma))</span>
<span id="cb229-4"><a href="slumpvariabler.html#cb229-4" tabindex="-1"></a></span>
<span id="cb229-5"><a href="slumpvariabler.html#cb229-5" tabindex="-1"></a>g1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dat_norm, <span class="fu">aes</span>(x, p)) <span class="sc">+</span></span>
<span id="cb229-6"><a href="slumpvariabler.html#cb229-6" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb229-7"><a href="slumpvariabler.html#cb229-7" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> <span class="dv">0</span>, <span class="at">ymax =</span> p), <span class="at">data =</span> dat_norm <span class="sc">%&gt;%</span> <span class="fu">filter</span>(x <span class="sc">&lt;</span> x_value), <span class="at">fill =</span> <span class="st">&quot;salmon&quot;</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb229-8"><a href="slumpvariabler.html#cb229-8" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Täthetsfunktion&quot;</span>)</span>
<span id="cb229-9"><a href="slumpvariabler.html#cb229-9" tabindex="-1"></a></span>
<span id="cb229-10"><a href="slumpvariabler.html#cb229-10" tabindex="-1"></a>g2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dat_norm, <span class="fu">aes</span>(x, P)) <span class="sc">+</span></span>
<span id="cb229-11"><a href="slumpvariabler.html#cb229-11" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb229-12"><a href="slumpvariabler.html#cb229-12" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;segment&quot;</span>, <span class="at">x =</span> x_value, <span class="at">y =</span> <span class="dv">0</span>, <span class="at">xend =</span> x_value, <span class="at">yend =</span> P_value) <span class="sc">+</span></span>
<span id="cb229-13"><a href="slumpvariabler.html#cb229-13" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;segment&quot;</span>, <span class="at">x =</span> x_value, <span class="at">y =</span> P_value, <span class="at">xend =</span> <span class="sc">-</span><span class="cn">Inf</span>, <span class="at">yend =</span> P_value) <span class="sc">+</span></span>
<span id="cb229-14"><a href="slumpvariabler.html#cb229-14" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Fördelningsfunktion&quot;</span>)</span>
<span id="cb229-15"><a href="slumpvariabler.html#cb229-15" tabindex="-1"></a></span>
<span id="cb229-16"><a href="slumpvariabler.html#cb229-16" tabindex="-1"></a><span class="co"># install.packages(&quot;patchwork&quot;)</span></span>
<span id="cb229-17"><a href="slumpvariabler.html#cb229-17" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb229-18"><a href="slumpvariabler.html#cb229-18" tabindex="-1"></a>g1 <span class="sc">/</span> g2</span></code></pre></div>
<p><img src="R-anvisningar_files/figure-html/unnamed-chunk-145-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Sannolikheten att ligga under ett värde på x ges av kurvan för fördelningsfunktionen vid det x-värdet. Det motsvarar den fyllda ytan under täthetsfunktionen till vänster om x-värdet.</p>
<div class="exercise">
<p><span id="exr:unlabeled-div-77" class="exercise"><strong>Uppgift 3.17  (Sannolikhet från normalfördelningen) </strong></span>Fyll i kodstycket nedan för att beräkna sannolikheten att få ett värde under minus två i en normalfördelning med medelvärde 0 och standardavvikelse 1, och i en normalfördelning med medelvärde 1 och standardavvikelse 2.</p>
<div class="sourceCode" id="cb230"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb230-1"><a href="slumpvariabler.html#cb230-1" tabindex="-1"></a><span class="fu">pnorm</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="at">mean =</span> ___, <span class="at">sd =</span> ___)</span>
<span id="cb230-2"><a href="slumpvariabler.html#cb230-2" tabindex="-1"></a><span class="fu">pnorm</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="at">mean =</span> ___, <span class="at">sd =</span> ___)</span></code></pre></div>
</div>
<p>Om man vill ta fram en sannolikhet att ligga i ett visst intervall kan man ta skillnaden mellan två värden från fördelningsfunktionen. Sannolikheten att ligga mellan 1 och minus 1 i en normalfördelning med medelvärde 0 och standardavvikelse 1 ges till exempel av</p>
<div class="sourceCode" id="cb231"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb231-1"><a href="slumpvariabler.html#cb231-1" tabindex="-1"></a><span class="fu">pnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>) <span class="sc">-</span> <span class="fu">pnorm</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span></code></pre></div>
<pre><code>## [1] 0.6826895</code></pre>
<p>Den normalfördelningen (medelvärde 0 och standardavvikelse 1) kallas den <em>standardiserade</em> normalfördelning. Vi kan illustrerade med följande.</p>
<div class="sourceCode" id="cb233"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb233-1"><a href="slumpvariabler.html#cb233-1" tabindex="-1"></a>x_values <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb233-2"><a href="slumpvariabler.html#cb233-2" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb233-3"><a href="slumpvariabler.html#cb233-3" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb233-4"><a href="slumpvariabler.html#cb233-4" tabindex="-1"></a></span>
<span id="cb233-5"><a href="slumpvariabler.html#cb233-5" tabindex="-1"></a>dat_norm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="at">from =</span> mu <span class="sc">-</span> <span class="dv">4</span> <span class="sc">*</span> sigma, <span class="at">to =</span> mu <span class="sc">+</span> <span class="dv">4</span> <span class="sc">*</span> sigma, <span class="fl">0.1</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb233-6"><a href="slumpvariabler.html#cb233-6" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">p =</span> <span class="fu">dnorm</span>(x, <span class="at">mean =</span> mu, <span class="at">sd =</span> sigma))</span>
<span id="cb233-7"><a href="slumpvariabler.html#cb233-7" tabindex="-1"></a></span>
<span id="cb233-8"><a href="slumpvariabler.html#cb233-8" tabindex="-1"></a><span class="fu">ggplot</span>(dat_norm, <span class="fu">aes</span>(x, p)) <span class="sc">+</span></span>
<span id="cb233-9"><a href="slumpvariabler.html#cb233-9" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb233-10"><a href="slumpvariabler.html#cb233-10" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> <span class="dv">0</span>, <span class="at">ymax =</span> p), <span class="at">data =</span> dat_norm <span class="sc">%&gt;%</span> <span class="fu">filter</span>(x <span class="sc">&lt;</span> <span class="fu">max</span>(x_values) <span class="sc">&amp;</span> x <span class="sc">&gt;</span> <span class="fu">min</span>(x_values)), <span class="at">fill =</span> <span class="st">&quot;salmon&quot;</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb233-11"><a href="slumpvariabler.html#cb233-11" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Täthetsfunktion&quot;</span>)</span></code></pre></div>
<p><img src="R-anvisningar_files/figure-html/unnamed-chunk-148-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="exercise">
<p><span id="exr:unlabeled-div-78" class="exercise"><strong>Uppgift 3.18  (Sannolikhet mellan två värden) </strong></span>Fyll i kodstycket nedan för att beräkna sannolikheten att få ett värde mellan <em>minus två</em> och tre i en normalfördelning med medelvärde 1 och standardavvikelse 2.</p>
<div class="sourceCode" id="cb234"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb234-1"><a href="slumpvariabler.html#cb234-1" tabindex="-1"></a><span class="fu">pnorm</span>(___, <span class="at">mean =</span> ___, <span class="at">sd =</span> ___) <span class="sc">-</span> <span class="fu">pnorm</span>(___, <span class="at">mean =</span> ___, <span class="at">sd =</span> ___)</span></code></pre></div>
</div>
<p>Fördelningsfunktionen ger sannolikheten att ligga under ett visst x-värde. Man kan enkelt beräkna sannolikheten att ligga över värdet genom att ta ett minus fördelningsfunktionen. Sannolikheten att ligga över 1.96 i en standardiserad normalfördelning ges till exempel av ungeför 2.5 procent.</p>
<div class="sourceCode" id="cb235"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb235-1"><a href="slumpvariabler.html#cb235-1" tabindex="-1"></a><span class="dv">1</span> <span class="sc">-</span> <span class="fu">pnorm</span>(<span class="fl">1.96</span>)</span></code></pre></div>
<pre><code>## [1] 0.0249979</code></pre>
<div class="exercise">
<p><span id="exr:unlabeled-div-79" class="exercise"><strong>Uppgift 3.19  (Sannolikhet över x) </strong></span>Fyll i kodstycket nedan för att beräkna sannolikheten att få ett värde över sju i en normalfördelning med medelvärde 3 och standardavvikelse 5.</p>
<div class="sourceCode" id="cb237"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb237-1"><a href="slumpvariabler.html#cb237-1" tabindex="-1"></a><span class="dv">1</span> <span class="sc">-</span> <span class="fu">pnorm</span>(___, <span class="at">mean =</span> ___, <span class="at">sd =</span> ___)</span></code></pre></div>
</div>
<p>En normalfördelning kan transformeras till en annan normal genom att addera och multiplicera med någon konstant. Mer specifik kan vilken normalfördelning som helst återföras till en standardiserad normalfördelning genom att dra ifrån medelvärdet och dela med standardavvikelsen. Det här utnyttjas när man beräknar sannolikheter för hand. Säg till exempel att vi har en normalfördelning med medelvärde 8 och standardavvikelse 4, och vi vill ta fram sannolikheten att ligga under 7. Det kan beräknas med</p>
<div class="sourceCode" id="cb238"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb238-1"><a href="slumpvariabler.html#cb238-1" tabindex="-1"></a><span class="fu">pnorm</span>(<span class="dv">7</span>, <span class="at">mean =</span> <span class="dv">8</span>, <span class="at">sd =</span> <span class="dv">4</span>)</span></code></pre></div>
<pre><code>## [1] 0.4012937</code></pre>
<p>Alternativt kan man standardiserade genom att att ta 7 minus 8, delat på 4, vilket ger (7 - 8) / 4 = -0.25, och sedan göra sannolikhetsberäkningen i den standardiserade normalen.</p>
<div class="sourceCode" id="cb240"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb240-1"><a href="slumpvariabler.html#cb240-1" tabindex="-1"></a><span class="fu">pnorm</span>(<span class="sc">-</span><span class="fl">0.25</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span></code></pre></div>
<pre><code>## [1] 0.4012937</code></pre>
<div class="exercise">
<p><span id="exr:unlabeled-div-80" class="exercise"><strong>Uppgift 3.20  (Standardisering) </strong></span>En slumpvariabel Y följer en normalfördelning med medelvärde 2 och varians 9. Vad är sannolikheten att få</p>
<ul>
<li>P(Y &gt; 2.75),</li>
<li>P(Y &lt; 2.75),</li>
<li>P(2.30 &lt; Y &lt; 2.45)?</li>
</ul>
<p>Beräkna först sannolikheten för hand och sedan med <code>pnorm()</code>.
Notera att denna fråga finns bland instuderingsuppgifterna.</p>
</div>
</div>
<div id="bonus.-summan-av-två-slumpvariabler-med-slumptal" class="section level2 hasAnchor" number="3.7">
<h2><span class="header-section-number">3.7</span> Bonus. Summan av två slumpvariabler med slumptal<a href="slumpvariabler.html#bonus.-summan-av-två-slumpvariabler-med-slumptal" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Utöver funktioner för sannolikhetsfunktion (eller täthetsfunktion) och fördelningsfunktion (som <code>dbinom()</code>, <code>dpois()</code>, <code>dnorm()</code>, respektive <code>pbinom()</code>, <code>ppois()</code>, <code>pnorm()</code>) har R funktioner för att ta fram slumptal (<code>rbinom()</code>, <code>rpois()</code>, <code>rnorm()</code>). Slumptal kan vara användbara för att undersöka egenskaper hos en slumpprocess.</p>
<p>Låt oss som ett första exempel undersöka egenskaper hos poissonfördelningen genom att titta på följande fråga: om vi har två poissonfördelningar, med lambda 3 respektive 2, vilken fördelning har summan av de två fördelningarna? Vi kan t.ex. tänka oss att antalet blåsippor i en försöksruta är poissonfördelat med medelvärde 3 och antalet vitsippor är poissonfördelat med medelvärde 2, och att vi vill veta fördelningen för antalet blåsippor plus antalet vitsippor.</p>
<p>Vi börjar med att dra slumptal för en poissonfördelning med lambda lika med 3 och jämför slumptalen med en teoretisk fördelning.</p>
<div class="sourceCode" id="cb242"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb242-1"><a href="slumpvariabler.html#cb242-1" tabindex="-1"></a>dat_pois <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">rpois</span>(<span class="dv">10000</span>, <span class="at">lambda =</span> <span class="dv">3</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb242-2"><a href="slumpvariabler.html#cb242-2" tabindex="-1"></a>  <span class="fu">count</span>(x) <span class="sc">%&gt;%</span> </span>
<span id="cb242-3"><a href="slumpvariabler.html#cb242-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">p =</span> n <span class="sc">/</span> <span class="fu">sum</span>(n),</span>
<span id="cb242-4"><a href="slumpvariabler.html#cb242-4" tabindex="-1"></a>         <span class="at">theoretical_p =</span> <span class="fu">dpois</span>(x, <span class="at">lambda =</span> <span class="dv">3</span>))</span>
<span id="cb242-5"><a href="slumpvariabler.html#cb242-5" tabindex="-1"></a></span>
<span id="cb242-6"><a href="slumpvariabler.html#cb242-6" tabindex="-1"></a><span class="fu">ggplot</span>(dat_pois, <span class="fu">aes</span>(x, p)) <span class="sc">+</span></span>
<span id="cb242-7"><a href="slumpvariabler.html#cb242-7" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb242-8"><a href="slumpvariabler.html#cb242-8" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> theoretical_p))</span></code></pre></div>
<p><img src="R-anvisningar_files/figure-html/unnamed-chunk-154-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Linjen ger den teoretiska poissonfördelningen och punkterna ger fördelningen för slumptalen. Punkterna ligger nära linjen, vilket är helt efter förväntan. Notera dock att det kommer finnas vissa naturliga avvikelser när man arbetar med slumptal.</p>
<div class="exercise">
<p><span id="exr:unlabeled-div-81" class="exercise"><strong>Uppgift 3.21  (Poisson från slumptal) </strong></span>Gör lämpliga ändringar i kodstycket ovan för att göra motsvarande beräkning för en poissonfördelning med lambda lika med 2. Ligger slumptalen nära den teoretiska fördelningen?</p>
</div>
<p>Vi kan nu ta från två serier av slumptal, beräkna dess summa och jämföra med en teoretisk fördelning. Som teoretisk fördelning tar vi en poissonfördelning med lambda 5, eftersom 5 är summan av våra två lambdavärden.</p>
<div class="sourceCode" id="cb243"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb243-1"><a href="slumpvariabler.html#cb243-1" tabindex="-1"></a>dat_pois <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x1 =</span> <span class="fu">rpois</span>(<span class="dv">10000</span>, <span class="at">lambda =</span> <span class="dv">3</span>),</span>
<span id="cb243-2"><a href="slumpvariabler.html#cb243-2" tabindex="-1"></a>                       <span class="at">x2 =</span> <span class="fu">rpois</span>(<span class="dv">10000</span>, <span class="at">lambda =</span> <span class="dv">2</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb243-3"><a href="slumpvariabler.html#cb243-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">x =</span> x1 <span class="sc">+</span> x2) <span class="sc">%&gt;%</span> </span>
<span id="cb243-4"><a href="slumpvariabler.html#cb243-4" tabindex="-1"></a>  <span class="fu">count</span>(x) <span class="sc">%&gt;%</span> </span>
<span id="cb243-5"><a href="slumpvariabler.html#cb243-5" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">p =</span> n <span class="sc">/</span> <span class="fu">sum</span>(n),</span>
<span id="cb243-6"><a href="slumpvariabler.html#cb243-6" tabindex="-1"></a>         <span class="at">theoretical_p =</span> <span class="fu">dpois</span>(x, <span class="at">lambda =</span> <span class="dv">5</span>))</span>
<span id="cb243-7"><a href="slumpvariabler.html#cb243-7" tabindex="-1"></a></span>
<span id="cb243-8"><a href="slumpvariabler.html#cb243-8" tabindex="-1"></a><span class="fu">ggplot</span>(dat_pois, <span class="fu">aes</span>(x, p)) <span class="sc">+</span></span>
<span id="cb243-9"><a href="slumpvariabler.html#cb243-9" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb243-10"><a href="slumpvariabler.html#cb243-10" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> theoretical_p))</span></code></pre></div>
<p><img src="R-anvisningar_files/figure-html/unnamed-chunk-155-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Summans värden ligger när den teoretiska fördelningen. Det stödjer tanken att summan av två poissonfördelningar är poissonfördelad.</p>
<p>Vi såg tidigare hur utfallet av en tärning kan ses som en slumpvariabel (n stycken utfall där samtliga är lika sannolika) och att funktionen <code>sample()</code> kan användas för att simulera tärningskast. Vi kan utnyttja det för att undersöka fördelningen för summan av två tärningskast. Exemplet nedan tittar på en sex-sidig tärning.</p>
<div class="sourceCode" id="cb244"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb244-1"><a href="slumpvariabler.html#cb244-1" tabindex="-1"></a>dat_dice_sum <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x1 =</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>), <span class="at">size =</span> <span class="dv">10000</span>, <span class="at">replace =</span> T),</span>
<span id="cb244-2"><a href="slumpvariabler.html#cb244-2" tabindex="-1"></a>                           <span class="at">x2 =</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>), <span class="at">size =</span> <span class="dv">10000</span>, <span class="at">replace =</span> T)) <span class="sc">%&gt;%</span> </span>
<span id="cb244-3"><a href="slumpvariabler.html#cb244-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">x =</span> x1 <span class="sc">+</span> x2) <span class="sc">%&gt;%</span> </span>
<span id="cb244-4"><a href="slumpvariabler.html#cb244-4" tabindex="-1"></a>  <span class="fu">count</span>(x) <span class="sc">%&gt;%</span> </span>
<span id="cb244-5"><a href="slumpvariabler.html#cb244-5" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">p =</span> n <span class="sc">/</span> <span class="fu">sum</span>(n))</span>
<span id="cb244-6"><a href="slumpvariabler.html#cb244-6" tabindex="-1"></a></span>
<span id="cb244-7"><a href="slumpvariabler.html#cb244-7" tabindex="-1"></a><span class="fu">ggplot</span>(dat_dice_sum, <span class="fu">aes</span>(x, p)) <span class="sc">+</span></span>
<span id="cb244-8"><a href="slumpvariabler.html#cb244-8" tabindex="-1"></a>  <span class="fu">geom_col</span>()</span></code></pre></div>
<p><img src="R-anvisningar_files/figure-html/unnamed-chunk-156-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Summan av två tärningskast har en triangelformad fördelning där 7 är det vanligaste utfallet och 2 och 12 är de ovanligaste.</p>
<div class="exercise">
<p><span id="exr:unlabeled-div-82" class="exercise"><strong>Uppgift 3.22  (Summan av tärningskast med annan tärning) </strong></span>Gör lämpliga ändringar i stycket ovan för att beräkna summan av två utfall för en åtta-sidig tärning.</p>
</div>
<div class="exercise">
<p><span id="exr:unlabeled-div-83" class="exercise"><strong>Uppgift 3.23  (Summan av tre tärningskast) </strong></span>Gör lämpliga tillägg i stycket ovan för att beräkna summan av tre utfall för en sex-sidig tärning.</p>
</div>
</div>
<div id="bonus.-cirkelns-area-från-slumptal" class="section level2 hasAnchor" number="3.8">
<h2><span class="header-section-number">3.8</span> Bonus. Cirkelns area från slumptal<a href="slumpvariabler.html#bonus.-cirkelns-area-från-slumptal" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>En intressant aspekt av slumptal är att de kan användas till att utforska icke-slumpmässiga problem. Som exempel tar vi cirkelns area. I figuren nedan är en cirkel inskriven i en kvadrat. Kvadraten har sidor med längden två, så dess totala yta är fyra (två i kvadrat). Om man vet hur stor andel av ytan upptas av cirkeln kan man beräkna cirkelns area genom att ta den andelen gånger fyra. Från rent matematiska resultat vet vi att arean ska vara lika med pi, alltså runt 3.14.</p>
<div class="sourceCode" id="cb245"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb245-1"><a href="slumpvariabler.html#cb245-1" tabindex="-1"></a><span class="co"># install.packages(&quot;ggforce&quot;)</span></span>
<span id="cb245-2"><a href="slumpvariabler.html#cb245-2" tabindex="-1"></a><span class="fu">library</span>(ggforce)</span>
<span id="cb245-3"><a href="slumpvariabler.html#cb245-3" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb245-4"><a href="slumpvariabler.html#cb245-4" tabindex="-1"></a>  <span class="fu">geom_circle</span>(<span class="fu">aes</span>(<span class="at">x0 =</span> <span class="dv">0</span>, <span class="at">y0 =</span> <span class="dv">0</span>, <span class="at">r =</span> <span class="dv">1</span>)) <span class="sc">+</span> </span>
<span id="cb245-5"><a href="slumpvariabler.html#cb245-5" tabindex="-1"></a>  <span class="fu">geom_rect</span>(<span class="fu">aes</span>(<span class="at">xmin =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">ymin =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">xmax =</span> <span class="dv">1</span>, <span class="at">ymax =</span> <span class="dv">1</span>), <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>)</span>
<span id="cb245-6"><a href="slumpvariabler.html#cb245-6" tabindex="-1"></a>g</span></code></pre></div>
<p><img src="R-anvisningar_files/figure-html/fig3_pi1-1.png" width="384" style="display: block; margin: auto;" /></p>
<p>Funktionen <code>runif()</code> ger ett slumpmässigt värde mellan två gränsvärden (som sätts med argumenten <code>min</code> och <code>max</code>). Slumpmässiga punkter inom kvadraten kan dras genom att dra en x- och en y-koordinat. En fördelning där alla värden är lika sannolika kallas <em>uniform</em> (eller <em>likformig</em>).</p>
<div class="sourceCode" id="cb246"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb246-1"><a href="slumpvariabler.html#cb246-1" tabindex="-1"></a>dat_random <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">runif</span>(<span class="dv">100</span>, <span class="at">min =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">max =</span> <span class="dv">1</span>),</span>
<span id="cb246-2"><a href="slumpvariabler.html#cb246-2" tabindex="-1"></a>                         <span class="at">y =</span> <span class="fu">runif</span>(<span class="dv">100</span>, <span class="at">min =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">max =</span> <span class="dv">1</span>))</span>
<span id="cb246-3"><a href="slumpvariabler.html#cb246-3" tabindex="-1"></a></span>
<span id="cb246-4"><a href="slumpvariabler.html#cb246-4" tabindex="-1"></a>g <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="fu">aes</span>(x, y), <span class="at">data =</span> dat_random)</span></code></pre></div>
<p><img src="R-anvisningar_files/figure-html/fig3_pi2-1.png" width="384" style="display: block; margin: auto;" /></p>
<p>Pytagoras sats kan användas för att beräkna avståndet mellan en slumpmässig punkt och origo (nollpunkten). Punkter med ett avstånd under ett ligger inom cirkeln. Cirkelns area ska ges av andelen punkter i kvadraten som också ligger i cirkeln, gånger fyra.</p>
<div class="sourceCode" id="cb247"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb247-1"><a href="slumpvariabler.html#cb247-1" tabindex="-1"></a>dat_random <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">runif</span>(<span class="dv">100</span>, <span class="at">min =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">max =</span> <span class="dv">1</span>),</span>
<span id="cb247-2"><a href="slumpvariabler.html#cb247-2" tabindex="-1"></a>                         <span class="at">y =</span> <span class="fu">runif</span>(<span class="dv">100</span>, <span class="at">min =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">max =</span> <span class="dv">1</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb247-3"><a href="slumpvariabler.html#cb247-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">inner =</span> x<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> y<span class="sc">^</span><span class="dv">2</span> <span class="sc">&lt;</span> <span class="dv">1</span>)</span>
<span id="cb247-4"><a href="slumpvariabler.html#cb247-4" tabindex="-1"></a></span>
<span id="cb247-5"><a href="slumpvariabler.html#cb247-5" tabindex="-1"></a><span class="dv">4</span> <span class="sc">*</span> <span class="fu">mean</span>(dat_random<span class="sc">$</span>inner)</span></code></pre></div>
<pre><code>## [1] 3.32</code></pre>
<div class="sourceCode" id="cb249"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb249-1"><a href="slumpvariabler.html#cb249-1" tabindex="-1"></a>pi</span></code></pre></div>
<pre><code>## [1] 3.141593</code></pre>
<p>Den beräknade arean ligger inte så långt från konstanten pi.</p>
<div class="exercise">
<p><span id="exr:unlabeled-div-84" class="exercise"><strong>Uppgift 3.24  (Summan av tre tärningskast) </strong></span>Beräkningens precision ökar med antalet slumptal. Vad i kodstycket ovan ska ändras för att generera fler slumptal? Blir utfallet närmre det väntade värdet om antalet slumptal ökar?</p>
</div>
</div>
<div id="bonus.-slump-och-ordning---sierpinski-triangeln" class="section level2 hasAnchor" number="3.9">
<h2><span class="header-section-number">3.9</span> Bonus. Slump och ordning - Sierpinski-triangeln<a href="slumpvariabler.html#bonus.-slump-och-ordning---sierpinski-triangeln" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Slumpmässiga processer kan ge intressanta mönster. Ett exempel är följande procedur.</p>
<ol style="list-style-type: decimal">
<li>Ta tre <em>rampunkter</em> i planet så att de bildar en triangel.</li>
<li>Ta en <em>startpunkt</em> inom triangeln.</li>
<li>Välj slumpmässigt en av de tre rampunkterna och beräkna punkten mellan startpunkten och den valda rampunkten. Detta ger en ny punkt.</li>
<li>Välj slumpmässigt en av de tre rampunkterna och beräkna punkten mellan den nya punkten från föregående steg och rampunkten. Detta ger en ny punkt.</li>
<li>Upprepa steg 4 ett godtyckligt antal gånger.</li>
</ol>
<p>I R kan proceduren programmeras med en <code>for</code>-loop. Här ges ett exempel där 100 punkter genereras. Koden är viss överkurs och innehåller funktioner vi inte behöver till den övriga kursen.</p>
<div class="sourceCode" id="cb251"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb251-1"><a href="slumpvariabler.html#cb251-1" tabindex="-1"></a><span class="co"># Ta ut tre punkter</span></span>
<span id="cb251-2"><a href="slumpvariabler.html#cb251-2" tabindex="-1"></a>x_original <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb251-3"><a href="slumpvariabler.html#cb251-3" tabindex="-1"></a>y_original <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">2</span>,<span class="dv">0</span>)</span>
<span id="cb251-4"><a href="slumpvariabler.html#cb251-4" tabindex="-1"></a></span>
<span id="cb251-5"><a href="slumpvariabler.html#cb251-5" tabindex="-1"></a><span class="co"># Välj en punkt inom triangeln</span></span>
<span id="cb251-6"><a href="slumpvariabler.html#cb251-6" tabindex="-1"></a>x_new <span class="ot">&lt;-</span> <span class="fl">0.4</span></span>
<span id="cb251-7"><a href="slumpvariabler.html#cb251-7" tabindex="-1"></a>y_new <span class="ot">&lt;-</span> <span class="fl">0.2</span></span>
<span id="cb251-8"><a href="slumpvariabler.html#cb251-8" tabindex="-1"></a>dat_tri <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> x_new, <span class="at">y =</span> y_new)</span>
<span id="cb251-9"><a href="slumpvariabler.html#cb251-9" tabindex="-1"></a></span>
<span id="cb251-10"><a href="slumpvariabler.html#cb251-10" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb251-11"><a href="slumpvariabler.html#cb251-11" tabindex="-1"></a></span>
<span id="cb251-12"><a href="slumpvariabler.html#cb251-12" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb251-13"><a href="slumpvariabler.html#cb251-13" tabindex="-1"></a>  new_point <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>), <span class="dv">1</span>)</span>
<span id="cb251-14"><a href="slumpvariabler.html#cb251-14" tabindex="-1"></a>  x_new <span class="ot">&lt;-</span> (x_new <span class="sc">+</span> x_original[new_point]) <span class="sc">/</span> <span class="dv">2</span></span>
<span id="cb251-15"><a href="slumpvariabler.html#cb251-15" tabindex="-1"></a>  y_new <span class="ot">&lt;-</span> (y_new <span class="sc">+</span> y_original[new_point]) <span class="sc">/</span> <span class="dv">2</span></span>
<span id="cb251-16"><a href="slumpvariabler.html#cb251-16" tabindex="-1"></a>  </span>
<span id="cb251-17"><a href="slumpvariabler.html#cb251-17" tabindex="-1"></a>  dat_tri <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(dat_tri, <span class="fu">data.frame</span>(<span class="at">x =</span> x_new, <span class="at">y =</span> y_new))</span>
<span id="cb251-18"><a href="slumpvariabler.html#cb251-18" tabindex="-1"></a>}</span>
<span id="cb251-19"><a href="slumpvariabler.html#cb251-19" tabindex="-1"></a></span>
<span id="cb251-20"><a href="slumpvariabler.html#cb251-20" tabindex="-1"></a><span class="fu">ggplot</span>(dat_tri, <span class="fu">aes</span>(x, y)) <span class="sc">+</span></span>
<span id="cb251-21"><a href="slumpvariabler.html#cb251-21" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div>
<div class="exercise">
<p><span id="exr:unlabeled-div-85" class="exercise"><strong>Uppgift 3.25  (Sierpinski-triangeln) </strong></span>Vad måste ändras i stycket ovan för att generera fler punkter? Tiotusen kan vara ett lämpligt antal för en tydligare illustration. Vad händer om man ändrar värdena i <code>x_original</code> och <code>y_original</code>?</p>
</div>
</div>
<div id="valfria-hemuppgifter-2" class="section level2 hasAnchor" number="3.10">
<h2><span class="header-section-number">3.10</span> Valfria hemuppgifter<a href="slumpvariabler.html#valfria-hemuppgifter-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="exercise">
<p><span id="exr:unlabeled-div-86" class="exercise"><strong>Uppgift 3.26  (Sierpinski-pyramiden) </strong></span>Stycket nedan skapar en tredimensionell variant av Sierpinski-triangeln.</p>
<div class="sourceCode" id="cb252"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb252-1"><a href="slumpvariabler.html#cb252-1" tabindex="-1"></a>x_original <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb252-2"><a href="slumpvariabler.html#cb252-2" tabindex="-1"></a>y_original <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb252-3"><a href="slumpvariabler.html#cb252-3" tabindex="-1"></a>z_original <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">2</span>,<span class="dv">0</span>)</span>
<span id="cb252-4"><a href="slumpvariabler.html#cb252-4" tabindex="-1"></a></span>
<span id="cb252-5"><a href="slumpvariabler.html#cb252-5" tabindex="-1"></a>x_new <span class="ot">&lt;-</span> <span class="fl">0.4</span></span>
<span id="cb252-6"><a href="slumpvariabler.html#cb252-6" tabindex="-1"></a>y_new <span class="ot">&lt;-</span> <span class="fl">0.2</span></span>
<span id="cb252-7"><a href="slumpvariabler.html#cb252-7" tabindex="-1"></a>z_new <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb252-8"><a href="slumpvariabler.html#cb252-8" tabindex="-1"></a>dat_tri <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> x_new, <span class="at">y =</span> y_new, <span class="at">z =</span> z_new)</span>
<span id="cb252-9"><a href="slumpvariabler.html#cb252-9" tabindex="-1"></a></span>
<span id="cb252-10"><a href="slumpvariabler.html#cb252-10" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span> <span class="co"># Antal skapade punkter</span></span>
<span id="cb252-11"><a href="slumpvariabler.html#cb252-11" tabindex="-1"></a></span>
<span id="cb252-12"><a href="slumpvariabler.html#cb252-12" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb252-13"><a href="slumpvariabler.html#cb252-13" tabindex="-1"></a>  new_point <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>), <span class="dv">1</span>)</span>
<span id="cb252-14"><a href="slumpvariabler.html#cb252-14" tabindex="-1"></a>  x_new <span class="ot">&lt;-</span> (x_new <span class="sc">+</span> x_original[new_point]) <span class="sc">/</span> <span class="dv">2</span></span>
<span id="cb252-15"><a href="slumpvariabler.html#cb252-15" tabindex="-1"></a>  y_new <span class="ot">&lt;-</span> (y_new <span class="sc">+</span> y_original[new_point]) <span class="sc">/</span> <span class="dv">2</span></span>
<span id="cb252-16"><a href="slumpvariabler.html#cb252-16" tabindex="-1"></a>  z_new <span class="ot">&lt;-</span> (z_new <span class="sc">+</span> z_original[new_point]) <span class="sc">/</span> <span class="dv">2</span></span>
<span id="cb252-17"><a href="slumpvariabler.html#cb252-17" tabindex="-1"></a>  </span>
<span id="cb252-18"><a href="slumpvariabler.html#cb252-18" tabindex="-1"></a>  dat_tri <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(dat_tri, <span class="fu">data.frame</span>(<span class="at">x =</span> x_new, <span class="at">y =</span> y_new, <span class="at">z =</span> z_new))</span>
<span id="cb252-19"><a href="slumpvariabler.html#cb252-19" tabindex="-1"></a>}</span>
<span id="cb252-20"><a href="slumpvariabler.html#cb252-20" tabindex="-1"></a></span>
<span id="cb252-21"><a href="slumpvariabler.html#cb252-21" tabindex="-1"></a><span class="fu">ggplot</span>(dat_tri, <span class="fu">aes</span>(x, y)) <span class="sc">+</span></span>
<span id="cb252-22"><a href="slumpvariabler.html#cb252-22" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span>
<span id="cb252-23"><a href="slumpvariabler.html#cb252-23" tabindex="-1"></a></span>
<span id="cb252-24"><a href="slumpvariabler.html#cb252-24" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb252-25"><a href="slumpvariabler.html#cb252-25" tabindex="-1"></a><span class="fu">plot_ly</span>(dat_tri, <span class="at">x =</span> <span class="sc">~</span>x, <span class="at">y =</span> <span class="sc">~</span>y, <span class="at">z =</span> <span class="sc">~</span>z) <span class="sc">%&gt;%</span> </span>
<span id="cb252-26"><a href="slumpvariabler.html#cb252-26" tabindex="-1"></a>  <span class="fu">add_markers</span>(<span class="at">size =</span> <span class="fl">0.1</span>)</span></code></pre></div>
<p>Vad måste ändras för att få fler punkter (<code>n</code>)?</p>
<p>(Om grafen inte laddas i <em>Viewer</em> utan ger felet <em>WebGL is not supported</em>, testa att öppna den i en webläsare genom att trycka på kanppen som ser ut som ett fönster med en pil i viewer-fönstret.)</p>
</div>
<div class="exercise">
<p><span id="exr:unlabeled-div-87" class="exercise"><strong>Uppgift 3.27  (Pyramidens bas) </strong></span>Vad händer om man ändrar värdena i <code>x_original</code>?</p>
</div>
<div class="exercise">
<p><span id="exr:unlabeled-div-88" class="exercise"><strong>Uppgift 3.28  (Mandelbrot) </strong></span>Sierpinski-triangeln är ett exempel på en fraktal - en mängd som ser likadan ut oavsett inzoomning. Det mest kända exemplet på en fraktal är Mandelbrot-mängden. R-paketet <em>mandelbrot</em> kan producera och visualisera.</p>
<div class="sourceCode" id="cb253"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb253-1"><a href="slumpvariabler.html#cb253-1" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;mandelbrot&quot;</span>)</span>
<span id="cb253-2"><a href="slumpvariabler.html#cb253-2" tabindex="-1"></a><span class="fu">library</span>(mandelbrot)</span>
<span id="cb253-3"><a href="slumpvariabler.html#cb253-3" tabindex="-1"></a>mb <span class="ot">&lt;-</span> <span class="fu">mandelbrot</span>()</span>
<span id="cb253-4"><a href="slumpvariabler.html#cb253-4" tabindex="-1"></a><span class="fu">plot</span>(mb)</span></code></pre></div>
</div>
<div class="exercise">
<p><span id="exr:unlabeled-div-89" class="exercise"><strong>Uppgift 3.29  (Ändrade färger) </strong></span>Titta på hjälpsidan till <code>mandelbrot_palette</code> genom att köra <code>?mandelbrot_palette</code>. Använd exemplet längst ned för att skapa en färglagd graf.</p>
</div>
<div class="exercise">
<p><span id="exr:unlabeled-div-90" class="exercise"><strong>Uppgift 3.30  (Barnsley Fern) </strong></span>Barnsleys ormbunke är ett exempel på en fraktal som efterliknar en naturlig växt. Se wikipediasidan <a href="https://en.wikipedia.org/wiki/Barnsley_fern" class="uri">https://en.wikipedia.org/wiki/Barnsley_fern</a> för en beskrivning. Kör R-koden från wikipediasidan för ett exempel i R. Vad måste ändras för att få fler punkter i grafen?</p>
</div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="beskrivande-statistik.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="ett-stickprov-av-normalfördelad-data.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "sepia",
"family": "serif",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["R-anvisningar.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
