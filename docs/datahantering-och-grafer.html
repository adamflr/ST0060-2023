<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>1 Datahantering och grafer | R-anvisningar till Grundläggande statistik</title>
  <meta name="description" content="1 Datahantering och grafer | R-anvisningar till Grundläggande statistik" />
  <meta name="generator" content="bookdown 0.34 and GitBook 2.6.7" />

  <meta property="og:title" content="1 Datahantering och grafer | R-anvisningar till Grundläggande statistik" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="1 Datahantering och grafer | R-anvisningar till Grundläggande statistik" />
  
  
  



<meta name="date" content="2023-09-07" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="installation-av-r-och-rstudio.html"/>
<link rel="next" href="beskrivande-statistik.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">R-anvisningar</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduktion</a></li>
<li class="chapter" data-level="" data-path="installation-av-r-och-rstudio.html"><a href="installation-av-r-och-rstudio.html"><i class="fa fa-check"></i>Installation av R och RStudio</a>
<ul>
<li class="chapter" data-level="0.1" data-path="installation-av-r-och-rstudio.html"><a href="installation-av-r-och-rstudio.html#inledning"><i class="fa fa-check"></i><b>0.1</b> Inledning</a></li>
<li class="chapter" data-level="0.2" data-path="installation-av-r-och-rstudio.html"><a href="installation-av-r-och-rstudio.html#installation-av-r"><i class="fa fa-check"></i><b>0.2</b> Installation av R</a></li>
<li class="chapter" data-level="0.3" data-path="installation-av-r-och-rstudio.html"><a href="installation-av-r-och-rstudio.html#installation-av-rstudio"><i class="fa fa-check"></i><b>0.3</b> Installation av RStudio</a></li>
<li class="chapter" data-level="0.4" data-path="installation-av-r-och-rstudio.html"><a href="installation-av-r-och-rstudio.html#gränssnittet-i-rstudio"><i class="fa fa-check"></i><b>0.4</b> Gränssnittet i RStudio</a></li>
<li class="chapter" data-level="0.5" data-path="installation-av-r-och-rstudio.html"><a href="installation-av-r-och-rstudio.html#paket-i-r"><i class="fa fa-check"></i><b>0.5</b> Paket i R</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="datahantering-och-grafer.html"><a href="datahantering-och-grafer.html"><i class="fa fa-check"></i><b>1</b> Datahantering och grafer</a>
<ul>
<li class="chapter" data-level="1.1" data-path="datahantering-och-grafer.html"><a href="datahantering-och-grafer.html#uppstart-och-orientering"><i class="fa fa-check"></i><b>1.1</b> Uppstart och orientering</a></li>
<li class="chapter" data-level="1.2" data-path="datahantering-och-grafer.html"><a href="datahantering-och-grafer.html#packages-från-cran"><i class="fa fa-check"></i><b>1.2</b> <em>Packages</em> från CRAN</a></li>
<li class="chapter" data-level="1.3" data-path="datahantering-och-grafer.html"><a href="datahantering-och-grafer.html#objekt-och-funktioner"><i class="fa fa-check"></i><b>1.3</b> Objekt och funktioner</a></li>
<li class="chapter" data-level="1.4" data-path="datahantering-och-grafer.html"><a href="datahantering-och-grafer.html#sekvenser-av-funktioner"><i class="fa fa-check"></i><b>1.4</b> Sekvenser av funktioner</a></li>
<li class="chapter" data-level="1.5" data-path="datahantering-och-grafer.html"><a href="datahantering-och-grafer.html#datainskrivning-och-dataimport-från-web"><i class="fa fa-check"></i><b>1.5</b> Datainskrivning och dataimport från web</a>
<ul>
<li class="chapter" data-level="1.5.1" data-path="datahantering-och-grafer.html"><a href="datahantering-och-grafer.html#inskrivning-av-data"><i class="fa fa-check"></i><b>1.5.1</b> Inskrivning av data</a></li>
<li class="chapter" data-level="1.5.2" data-path="datahantering-och-grafer.html"><a href="datahantering-och-grafer.html#import-från-en-extern-fil"><i class="fa fa-check"></i><b>1.5.2</b> Import från en extern fil</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="datahantering-och-grafer.html"><a href="datahantering-och-grafer.html#urval-ur-en-tabell-med-select-och-filter"><i class="fa fa-check"></i><b>1.6</b> Urval ur en tabell med <code>select</code> och <code>filter</code></a></li>
<li class="chapter" data-level="1.7" data-path="datahantering-och-grafer.html"><a href="datahantering-och-grafer.html#grafer-med-ggplot2"><i class="fa fa-check"></i><b>1.7</b> Grafer med <code>ggplot2</code></a></li>
<li class="chapter" data-level="1.8" data-path="datahantering-och-grafer.html"><a href="datahantering-och-grafer.html#bonus.-interaktiva-grafer-med-plotly"><i class="fa fa-check"></i><b>1.8</b> Bonus. Interaktiva grafer med <code>plotly</code></a></li>
<li class="chapter" data-level="1.9" data-path="datahantering-och-grafer.html"><a href="datahantering-och-grafer.html#bonus.-warming-stripes"><i class="fa fa-check"></i><b>1.9</b> Bonus. Warming stripes</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="beskrivande-statistik.html"><a href="beskrivande-statistik.html"><i class="fa fa-check"></i><b>2</b> Beskrivande statistik</a>
<ul>
<li class="chapter" data-level="2.1" data-path="beskrivande-statistik.html"><a href="beskrivande-statistik.html#repetition-från-datorövning-1"><i class="fa fa-check"></i><b>2.1</b> Repetition från datorövning 1</a></li>
<li class="chapter" data-level="2.2" data-path="beskrivande-statistik.html"><a href="beskrivande-statistik.html#import-av-data-från-en-excelfil"><i class="fa fa-check"></i><b>2.2</b> Import av data från en Excelfil</a></li>
<li class="chapter" data-level="2.3" data-path="beskrivande-statistik.html"><a href="beskrivande-statistik.html#ändra-och-skapa-nya-kolumner-med-mutate"><i class="fa fa-check"></i><b>2.3</b> Ändra och skapa nya kolumner med <code>mutate</code></a></li>
<li class="chapter" data-level="2.4" data-path="beskrivande-statistik.html"><a href="beskrivande-statistik.html#sammanfattande-lägesmått"><i class="fa fa-check"></i><b>2.4</b> Sammanfattande lägesmått</a></li>
<li class="chapter" data-level="2.5" data-path="beskrivande-statistik.html"><a href="beskrivande-statistik.html#sammanfattande-spridningsmått"><i class="fa fa-check"></i><b>2.5</b> Sammanfattande spridningsmått</a></li>
<li class="chapter" data-level="2.6" data-path="beskrivande-statistik.html"><a href="beskrivande-statistik.html#ordna-upp-beskrivande-statistik-och-exportera"><i class="fa fa-check"></i><b>2.6</b> Ordna upp beskrivande statistik och exportera</a></li>
<li class="chapter" data-level="2.7" data-path="beskrivande-statistik.html"><a href="beskrivande-statistik.html#kumulativt-medelvärde"><i class="fa fa-check"></i><b>2.7</b> Kumulativt medelvärde</a></li>
<li class="chapter" data-level="2.8" data-path="beskrivande-statistik.html"><a href="beskrivande-statistik.html#darwin-exempel"><i class="fa fa-check"></i><b>2.8</b> Darwin-exempel</a></li>
<li class="chapter" data-level="2.9" data-path="beskrivande-statistik.html"><a href="beskrivande-statistik.html#bonus.-tredimensionella-grafer-med-plotly"><i class="fa fa-check"></i><b>2.9</b> Bonus. Tredimensionella grafer med <code>plotly</code></a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="slumpvariabler.html"><a href="slumpvariabler.html"><i class="fa fa-check"></i><b>3</b> Slumpvariabler</a>
<ul>
<li class="chapter" data-level="3.1" data-path="slumpvariabler.html"><a href="slumpvariabler.html#repetition-från-datorövning-2"><i class="fa fa-check"></i><b>3.1</b> Repetition från datorövning 2</a></li>
<li class="chapter" data-level="3.2" data-path="slumpvariabler.html"><a href="slumpvariabler.html#diskreta-fördelningar-i-allmänhet"><i class="fa fa-check"></i><b>3.2</b> Diskreta fördelningar i allmänhet</a></li>
<li class="chapter" data-level="3.3" data-path="slumpvariabler.html"><a href="slumpvariabler.html#särskilda-diskreta-fördelningar-binomialfördelning"><i class="fa fa-check"></i><b>3.3</b> Särskilda diskreta fördelningar: binomialfördelning</a></li>
<li class="chapter" data-level="3.4" data-path="slumpvariabler.html"><a href="slumpvariabler.html#särskilda-diskreta-fördelningar-poissonfördelning"><i class="fa fa-check"></i><b>3.4</b> Särskilda diskreta fördelningar: poissonfördelning</a></li>
<li class="chapter" data-level="3.5" data-path="slumpvariabler.html"><a href="slumpvariabler.html#kontinuerliga-fördelningar-i-allmänhet"><i class="fa fa-check"></i><b>3.5</b> Kontinuerliga fördelningar i allmänhet</a></li>
<li class="chapter" data-level="3.6" data-path="slumpvariabler.html"><a href="slumpvariabler.html#särskilda-kontinuerliga-fördelningar-normalfördelningen"><i class="fa fa-check"></i><b>3.6</b> Särskilda kontinuerliga fördelningar: normalfördelningen</a></li>
<li class="chapter" data-level="3.7" data-path="slumpvariabler.html"><a href="slumpvariabler.html#bonus.-summan-av-två-slumpvariabler-med-slumptal"><i class="fa fa-check"></i><b>3.7</b> Bonus. Summan av två slumpvariabler med slumptal</a></li>
<li class="chapter" data-level="3.8" data-path="slumpvariabler.html"><a href="slumpvariabler.html#bonus.-cirkelns-area-från-slumptal"><i class="fa fa-check"></i><b>3.8</b> Bonus. Cirkelns area från slumptal</a></li>
<li class="chapter" data-level="3.9" data-path="slumpvariabler.html"><a href="slumpvariabler.html#bonus.-slump-och-ordning---sierpinski-triangeln"><i class="fa fa-check"></i><b>3.9</b> Bonus. Slump och ordning - Sierpinski-triangeln</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="ett-stickprov-av-normalfördelad-data.html"><a href="ett-stickprov-av-normalfördelad-data.html"><i class="fa fa-check"></i><b>4</b> Ett stickprov av normalfördelad data</a>
<ul>
<li class="chapter" data-level="4.1" data-path="ett-stickprov-av-normalfördelad-data.html"><a href="ett-stickprov-av-normalfördelad-data.html#repetition-av-datorövning-3"><i class="fa fa-check"></i><b>4.1</b> Repetition av datorövning 3</a></li>
<li class="chapter" data-level="4.2" data-path="ett-stickprov-av-normalfördelad-data.html"><a href="ett-stickprov-av-normalfördelad-data.html#test-av-medelvärde-för-normalfördelad-data"><i class="fa fa-check"></i><b>4.2</b> Test av medelvärde för normalfördelad data</a></li>
<li class="chapter" data-level="4.3" data-path="ett-stickprov-av-normalfördelad-data.html"><a href="ett-stickprov-av-normalfördelad-data.html#konfidensintervall-för-normalfördelad-data"><i class="fa fa-check"></i><b>4.3</b> Konfidensintervall för normalfördelad data</a></li>
<li class="chapter" data-level="4.4" data-path="ett-stickprov-av-normalfördelad-data.html"><a href="ett-stickprov-av-normalfördelad-data.html#normalfördelad-data-och-centrala-gränsvärdesatsen"><i class="fa fa-check"></i><b>4.4</b> Normalfördelad data och centrala gränsvärdesatsen</a></li>
<li class="chapter" data-level="4.5" data-path="ett-stickprov-av-normalfördelad-data.html"><a href="ett-stickprov-av-normalfördelad-data.html#bonus.-simuleringar-för-t-test-och-konfidensintervall"><i class="fa fa-check"></i><b>4.5</b> Bonus. Simuleringar för t-test och konfidensintervall</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="ett-stickprov-av-icke-normalfördelad-data.html"><a href="ett-stickprov-av-icke-normalfördelad-data.html"><i class="fa fa-check"></i><b>5</b> Ett stickprov av icke-normalfördelad data</a>
<ul>
<li class="chapter" data-level="5.1" data-path="ett-stickprov-av-icke-normalfördelad-data.html"><a href="ett-stickprov-av-icke-normalfördelad-data.html#repetition-av-datorövning-4"><i class="fa fa-check"></i><b>5.1</b> Repetition av datorövning 4</a></li>
<li class="chapter" data-level="5.2" data-path="ett-stickprov-av-icke-normalfördelad-data.html"><a href="ett-stickprov-av-icke-normalfördelad-data.html#proportioner-från-binär-data"><i class="fa fa-check"></i><b>5.2</b> Proportioner från binär data</a></li>
<li class="chapter" data-level="5.3" data-path="ett-stickprov-av-icke-normalfördelad-data.html"><a href="ett-stickprov-av-icke-normalfördelad-data.html#konfidensintervall-för-proportioner"><i class="fa fa-check"></i><b>5.3</b> Konfidensintervall för proportioner</a></li>
<li class="chapter" data-level="5.4" data-path="ett-stickprov-av-icke-normalfördelad-data.html"><a href="ett-stickprov-av-icke-normalfördelad-data.html#chi-två-test-för-goodness-of-fit"><i class="fa fa-check"></i><b>5.4</b> Chi-två-test för goodness-of-fit</a></li>
<li class="chapter" data-level="5.5" data-path="ett-stickprov-av-icke-normalfördelad-data.html"><a href="ett-stickprov-av-icke-normalfördelad-data.html#chi-två-test-när-någon-parameter-skattas-från-datan"><i class="fa fa-check"></i><b>5.5</b> Chi-två-test när någon parameter skattas från datan</a></li>
<li class="chapter" data-level="5.6" data-path="ett-stickprov-av-icke-normalfördelad-data.html"><a href="ett-stickprov-av-icke-normalfördelad-data.html#bonus.-interaktiva-kartor-med-leaflet"><i class="fa fa-check"></i><b>5.6</b> Bonus. Interaktiva kartor med leaflet</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="test-för-två-stickprov.html"><a href="test-för-två-stickprov.html"><i class="fa fa-check"></i><b>6</b> Test för två stickprov</a>
<ul>
<li class="chapter" data-level="6.1" data-path="test-för-två-stickprov.html"><a href="test-för-två-stickprov.html#repetition-av-datorövning-5"><i class="fa fa-check"></i><b>6.1</b> Repetition av datorövning 5</a></li>
<li class="chapter" data-level="6.2" data-path="test-för-två-stickprov.html"><a href="test-för-två-stickprov.html#två-stickprov-och-normalfördelad-data"><i class="fa fa-check"></i><b>6.2</b> Två stickprov och normalfördelad data</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="test-för-två-stickprov.html"><a href="test-för-två-stickprov.html#t-test-för-två-matchade-stickprov"><i class="fa fa-check"></i><b>6.2.1</b> t-test för två matchade stickprov</a></li>
<li class="chapter" data-level="6.2.2" data-path="test-för-två-stickprov.html"><a href="test-för-två-stickprov.html#t-test-för-två-oberoende-stickprov"><i class="fa fa-check"></i><b>6.2.2</b> t-test för två oberoende stickprov</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="test-för-två-stickprov.html"><a href="test-för-två-stickprov.html#z-test-och-konfidensintervall-för-två-proportioner"><i class="fa fa-check"></i><b>6.3</b> z-test och konfidensintervall för två proportioner</a></li>
<li class="chapter" data-level="6.4" data-path="test-för-två-stickprov.html"><a href="test-för-två-stickprov.html#chi-två-test-för-korstabeller"><i class="fa fa-check"></i><b>6.4</b> Chi-två-test för korstabeller</a></li>
<li class="chapter" data-level="6.5" data-path="test-för-två-stickprov.html"><a href="test-för-två-stickprov.html#bonus.-bilder-i-r"><i class="fa fa-check"></i><b>6.5</b> Bonus. Bilder i R</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="variansanalys.html"><a href="variansanalys.html"><i class="fa fa-check"></i><b>7</b> Variansanalys</a>
<ul>
<li class="chapter" data-level="7.1" data-path="variansanalys.html"><a href="variansanalys.html#repetition-av-datorövning-6"><i class="fa fa-check"></i><b>7.1</b> Repetition av datorövning 6</a></li>
<li class="chapter" data-level="7.2" data-path="variansanalys.html"><a href="variansanalys.html#allmänt"><i class="fa fa-check"></i><b>7.2</b> Allmänt</a></li>
<li class="chapter" data-level="7.3" data-path="variansanalys.html"><a href="variansanalys.html#variansanalys.-en-faktor"><i class="fa fa-check"></i><b>7.3</b> Variansanalys. En faktor</a></li>
<li class="chapter" data-level="7.4" data-path="variansanalys.html"><a href="variansanalys.html#variansanalys.-en-faktor-med-block"><i class="fa fa-check"></i><b>7.4</b> Variansanalys. En faktor med block</a></li>
<li class="chapter" data-level="7.5" data-path="variansanalys.html"><a href="variansanalys.html#variansanalys.-två-faktorer-med-block"><i class="fa fa-check"></i><b>7.5</b> Variansanalys. Två faktorer med block</a></li>
<li class="chapter" data-level="7.6" data-path="variansanalys.html"><a href="variansanalys.html#modellantaganden-och-residualer"><i class="fa fa-check"></i><b>7.6</b> Modellantaganden och residualer</a></li>
<li class="chapter" data-level="7.7" data-path="variansanalys.html"><a href="variansanalys.html#bonus.-statistik-för-ekologi"><i class="fa fa-check"></i><b>7.7</b> Bonus. Statistik för ekologi</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="regression-och-korrelation.html"><a href="regression-och-korrelation.html"><i class="fa fa-check"></i><b>8</b> Regression och korrelation</a>
<ul>
<li class="chapter" data-level="8.1" data-path="regression-och-korrelation.html"><a href="regression-och-korrelation.html#repetition-av-datorövning-7"><i class="fa fa-check"></i><b>8.1</b> Repetition av datorövning 7</a></li>
<li class="chapter" data-level="8.2" data-path="regression-och-korrelation.html"><a href="regression-och-korrelation.html#regression"><i class="fa fa-check"></i><b>8.2</b> Regression</a></li>
<li class="chapter" data-level="8.3" data-path="regression-och-korrelation.html"><a href="regression-och-korrelation.html#korrelation"><i class="fa fa-check"></i><b>8.3</b> Korrelation</a></li>
<li class="chapter" data-level="8.4" data-path="regression-och-korrelation.html"><a href="regression-och-korrelation.html#bonus.-skrapa-data-från-webbsidor"><i class="fa fa-check"></i><b>8.4</b> Bonus. Skrapa data från webbsidor</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R-anvisningar till <em>Grundläggande statistik</em></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="datahantering-och-grafer" class="section level1 hasAnchor" number="1">
<h1><span class="header-section-number">1</span> Datahantering och grafer<a href="datahantering-och-grafer.html#datahantering-och-grafer" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Datorövning 1 handlar om grunderna till R. Efter övningen ska vi kunna</p>
<ul>
<li><p>Starta RStudio och orientera oss i gränssnittet,</p></li>
<li><p>Installera och ladda tilläggspaket (<em>Packages</em>),</p></li>
<li><p>Definera objekt och tillämpa funktioner i R,</p></li>
<li><p>Importera data från en online-källa,</p></li>
<li><p>Transformera en tabell med data genom att välja kolumner, filtrera rader och summera per grupp,</p></li>
<li><p>Skapa grafer med <code>ggplot2</code>.</p></li>
</ul>
<div id="uppstart-och-orientering" class="section level2 hasAnchor" number="1.1">
<h2><span class="header-section-number">1.1</span> Uppstart och orientering<a href="datahantering-och-grafer.html#uppstart-och-orientering" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>För att arbeta i R måste vi installera språket R och ett gränssnitt för att arbeta i R, vanligen <em>RStudio</em>. Titta på kapitlet <em>Installation</em> om programmen inte är installerade på ditt system.</p>
<p>Starta RStudio, till exempel genom att gå till Startmenyn och söka på RStudio eller genom att dubbelklicka på en fil som öppnas i RStudio.
Gränssnittet i RStudio är uppdelat i fyra delar och varje del består av en eller flera flikar. De viktigaste är i nuläget</p>
<ul>
<li><em>Console</em> där kod körs och resultat skrivs ut,</li>
<li><em>Environment</em> där man ser skapade objekt,</li>
<li><em>History</em> där man ser tidigare körd kod,</li>
<li><em>Plots</em> där man ser skapade grafer, och</li>
<li><em>Help</em> där man ser hjälpsidor för funktioner.</li>
</ul>
<div class="exercise">
<p><span id="exr:unlabeled-div-1" class="exercise"><strong>Uppgift 1.1  (Help-fliken) </strong></span>Hitta fliken <em>Help</em>, klicka på husikonen under fliken. Finns det en länk med <em>RStudio Cheat Sheets</em>? Följ den länken för att hitta guider till R som kan bli nyttiga längre fram. För nu, gå tillbaka till RStudio.</p>
</div>
<p>Ofta skriver man inte sin kod direkt i konsollen, utan i ett separat <em>skript</em> - en vanlig textfil som innehåller den kod man vill köra. Genom att organisera sin kod i ett skript kan man lätt strukturera och dokumentera sitt arbete. I RStudio kan man öppna ett nytt skript genom att gå till <em>File &gt; New File &gt; R Script</em> eller genom att klicka <em>Ctrl + Shift + N</em>. Ett tomt skript öppnar sig då i det övre vänstra delfönstret. Om du läser det här i RStudio, genom att ha laddat ner .R-filen, läser du just nu ett skript.</p>
<div class="exercise">
<p><span id="exr:unlabeled-div-2" class="exercise"><strong>Uppgift 1.2  (Ett första skript) </strong></span>Öppna ett nytt skript genom File-menyn eller genom <em>Ctrl + Shift + N</em>.
Skriv</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="datahantering-och-grafer.html#cb4-1" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">5</span></span></code></pre></div>
<p>i skriptet och tryck <em>Ctrl + Enter</em>. Titta i flikarna <em>Console</em> och <em>Environment</em>. Har något hänt? Du bör se att koden i skriptet körts i konsollen och att ett nytt objekt <code>a</code> ligger i <em>Environment</em>.</p>
</div>
</div>
<div id="packages-från-cran" class="section level2 hasAnchor" number="1.2">
<h2><span class="header-section-number">1.2</span> <em>Packages</em> från CRAN<a href="datahantering-och-grafer.html#packages-från-cran" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>En av de stora styrkorna med R är att språket kan byggas ut av dess användare. De här tilläggen kan sedan samlas i paket (<em>packages</em>) och delas med andra. Rs officiella bibliotek för paket kallas för <em>CRAN</em> (<em>Comprehensive R Archive Network</em>).</p>
<p>För att använda ett specifikt paket måste det först installeras. Om man vet namnet på paketet man vill installera kan man köra</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="datahantering-och-grafer.html#cb5-1" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;tidyverse&quot;</span>)</span></code></pre></div>
<p>I det här fallet installeras paketet <code>tidyverse</code>, vilket innehåller funktioner för hantering av data.</p>
<p>I RStudio kan man också installera paket från <em>Packages</em>-fliken.</p>
<div class="exercise">
<p><span id="exr:unlabeled-div-3" class="exercise"><strong>Uppgift 1.3  (Installera tidyverse-paketet) </strong></span>Kör raden ovan för att installera <code>tidyverse</code>. Du kan antingen köra raden genom att skriva den i <em>Console</em> eller genom att skriva i ett skript och köra därifrån genom <em>Ctrl + Enter</em>.</p>
</div>
<div class="exercise">
<p><span id="exr:unlabeled-div-4" class="exercise"><strong>Uppgift 1.4  (Installera gapminder-paketet) </strong></span>Paketet <code>gapminder</code> innehåller lite intressant data vi kommer använda senare. Installera paketet <code>gapminder</code> genom att fylla i den saknade biten och köra raden nedan.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="datahantering-och-grafer.html#cb6-1" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;___&quot;</span>)</span></code></pre></div>
</div>
<p>Paket måste också laddas för varje ny session. Innan man kan använda innehållet i ett paket måste man därför köra</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="datahantering-och-grafer.html#cb7-1" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code></pre></div>
<div class="exercise">
<p><span id="exr:unlabeled-div-5" class="exercise"><strong>Uppgift 1.5  (Ladda gapminder-paketet) </strong></span>Ladda paketet <code>gapminder</code> genom att fylla i och köra raden nedan.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="datahantering-och-grafer.html#cb8-1" tabindex="-1"></a><span class="fu">library</span>(___)</span></code></pre></div>
</div>
<div class="exercise">
<p><span id="exr:unlabeled-div-6" class="exercise"><strong>Uppgift 1.6  (Paket som inte finns) </strong></span>Vad händer om man försöker installera ett paket som inte finns på <em>CRAN</em>? Testa till exempel</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="datahantering-och-grafer.html#cb9-1" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;ThisIsNotTheNameOfAnyPackage&quot;</span>)</span></code></pre></div>
<p>och</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="datahantering-och-grafer.html#cb10-1" tabindex="-1"></a><span class="fu">library</span>(ThisIsNotTheNameOfAnyPackage)</span></code></pre></div>
</div>
</div>
<div id="objekt-och-funktioner" class="section level2 hasAnchor" number="1.3">
<h2><span class="header-section-number">1.3</span> Objekt och funktioner<a href="datahantering-och-grafer.html#objekt-och-funktioner" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Ett <em>objekt</em> i R är en namngiven informationsmängd. Objekt kan se ut på många olika sätt - under kursens gång används objekt som består av insamlad data (konstruerade som vektorer eller tabeller), objekt som är statistiska modeller, och flera andra former. I R skapar man objekt med <em>assign</em>-pilen <code>&lt;-</code> (mindre än och bindestreck).</p>
<p>I ett tidigare exempel fanns raden</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="datahantering-och-grafer.html#cb11-1" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">5</span></span></code></pre></div>
<p>Här skapas ett objekt med namnet <code>a</code> som innehåller informationen <code>5</code>. <em>Assign</em>-pilen pekar alltså på det namn man vill ge objektet och pekar från objektets innehåll.</p>
<p>Ett lite mer komplicerat exempel på ett objekt ges av</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="datahantering-och-grafer.html#cb12-1" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">9</span>)</span></code></pre></div>
<p>Här skapas ett objekt <code>b</code> som innehåller en <em>serie</em> numeriska värden (en <em>vektor</em>). Värdena i en vektor är ordnade och man kan plocka ut ett specifikt värde med hakparenteser.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="datahantering-och-grafer.html#cb13-1" tabindex="-1"></a>b[<span class="dv">3</span>]               <span class="co"># Det tredje värdet i vektorn b</span></span></code></pre></div>
<pre><code>## [1] 4</code></pre>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="datahantering-och-grafer.html#cb15-1" tabindex="-1"></a>b[<span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">5</span>)]          <span class="co"># Det tredje och femte värdet i b</span></span></code></pre></div>
<pre><code>## [1] 4 5</code></pre>
<div class="exercise">
<p><span id="exr:unlabeled-div-7" class="exercise"><strong>Uppgift 1.7  (Skapa en vektor) </strong></span>Skapa ett objekt med namnet <code>new_vector</code> som innehåller värden 5, 7 och 10 genom att fylla i följande rad.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="datahantering-och-grafer.html#cb17-1" tabindex="-1"></a>new_vector <span class="ot">&lt;-</span> <span class="fu">c</span>(_, _, _)</span></code></pre></div>
</div>
<div class="exercise">
<p><span id="exr:unlabeled-div-8" class="exercise"><strong>Uppgift 1.8  (Ta ut andra värdet) </strong></span>Använd hakparenteser för att plocka ut det andra värdet ur vektorn <code>new_vector</code>.</p>
</div>
<p>Objekt kan manipuleras genom att tillämpa <em>funktioner</em>. En funktion tar någon ingående data och ger något utgående resultat. Funktioner anges genom att skriva funktionens namn följt av ingående data inom parenteser, och resultatet kan antingen skrivas ut i konsollen eller sparas som ett nytt objekt. En grundinstallation av R innehåller en mängd färdiga funktioner, t.ex.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="datahantering-och-grafer.html#cb18-1" tabindex="-1"></a><span class="fu">sum</span>(b)</span></code></pre></div>
<pre><code>## [1] 23</code></pre>
<p>vilket ger summan av värdena i vektorn <code>b</code>,</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="datahantering-och-grafer.html#cb20-1" tabindex="-1"></a><span class="fu">plot</span>(b)</span></code></pre></div>
<p><img src="R-anvisningar_files/figure-html/unnamed-chunk-20-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>som ger en simpel graf, och</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="datahantering-och-grafer.html#cb21-1" tabindex="-1"></a><span class="fu">sqrt</span>(b)</span></code></pre></div>
<pre><code>## [1] 1.732051 1.000000 2.000000 1.000000 2.236068 3.000000</code></pre>
<p>som beräknar kvadratroten för varje element i vektorn.</p>
<div class="exercise">
<p><span id="exr:unlabeled-div-9" class="exercise"><strong>Uppgift 1.9  (Summera vektorn) </strong></span>Fyll i och kör följande rad för att beräkna summan av vektorn <code>new_vector</code></p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="datahantering-och-grafer.html#cb23-1" tabindex="-1"></a><span class="fu">sum</span>(___)</span></code></pre></div>
</div>
<p>Vid konstruktionen av vektorn användes också en grundläggande funktion - funktionen <code>c()</code>, som tar en serie värden och skapar en sammanhängande vektor av värden.</p>
<p>Alla R-funktioner har en tillhörande hjälpfil som kan plockas fram genom att skriva frågetecken följt av funktionsnamnet, t.ex. <code>?sum</code>. Från hjälpfilen får man att <code>sum()</code> tar numeriska vektorer som ingående värde och beräknar summan. Man kan styra funktionens beteende genom att sätta ett argument <code>na.rm</code> (vilket här styr hur funktionen hanterar saknade värden). Som illustration kan man titta på</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="datahantering-och-grafer.html#cb24-1" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">9</span>, <span class="cn">NA</span>)           <span class="co"># Lägger till ett saknat värde</span></span>
<span id="cb24-2"><a href="datahantering-och-grafer.html#cb24-2" tabindex="-1"></a><span class="fu">sum</span>(b)                                 <span class="co"># na.rm = FALSE är grundinställning</span></span></code></pre></div>
<pre><code>## [1] NA</code></pre>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="datahantering-och-grafer.html#cb26-1" tabindex="-1"></a><span class="fu">sum</span>(b, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)                   <span class="co"># na.rm sätts till TRUE</span></span></code></pre></div>
<pre><code>## [1] 23</code></pre>
<p>Det första försöket <code>sum(b)</code> ger utfallet <code>NA</code>, men om man sätter <code>na.rm = TRUE</code> beräknas summan efter att det saknade värdet plockats bort. Notera också att skript kan kommenteras med <code>#</code>.</p>
</div>
<div id="sekvenser-av-funktioner" class="section level2 hasAnchor" number="1.4">
<h2><span class="header-section-number">1.4</span> Sekvenser av funktioner<a href="datahantering-och-grafer.html#sekvenser-av-funktioner" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Ofta vill man genomföra flera operationer på ett objekt. Man behöver då genomföra en sekvens av funktioner. Säg till exempel att man har värdena <span class="math display">\[(-4, -2, -1, 1, 2, 4)\]</span> och vill ta absolutvärde (vilket gör negativa tal till motsvarande positiva tal) och sedan summera.
Den typen av sekvenser kan genomföras på ett par olika sätt. Ett första sätt är att spara resultatet i varje steg och sedan använda utfallet i nästa steg:</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="datahantering-och-grafer.html#cb28-1" tabindex="-1"></a>c <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="sc">-</span><span class="dv">2</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>)            <span class="co"># Skapa en vektor av värden</span></span>
<span id="cb28-2"><a href="datahantering-och-grafer.html#cb28-2" tabindex="-1"></a>c_absolute <span class="ot">&lt;-</span> <span class="fu">abs</span>(c)                   <span class="co"># Ta absolutvärden. Spara som c_absolut</span></span>
<span id="cb28-3"><a href="datahantering-och-grafer.html#cb28-3" tabindex="-1"></a><span class="fu">sum</span>(c_absolute)                        <span class="co"># Summera värden i c_absolut</span></span></code></pre></div>
<pre><code>## [1] 14</code></pre>
<p>Här skapas ett objekt <code>c</code> som innehåller en vektor där några tal är negativa. I nästa rad används <code>abs</code> för att skapa absolutvärden. Slutligen summeras absolutvärdena med <code>sum</code>.
Notera att det är möjligt att skapa ett objekt med namnet <code>c</code> trots att det redan är namnet på en funktion - R förstår ur sammanhanget om objektet eller funktionen ska användas. Det kan dock bli lite oklart för en läsare, så försök som regel att undvika att skapa objekt med vanliga funktionsnamn som <code>sum</code> och <code>mean</code>.</p>
<div class="exercise">
<p><span id="exr:unlabeled-div-10" class="exercise"><strong>Uppgift 1.10  (Kvadrat, summa och roten ur) </strong></span>Fyll i och kör följande rader för att ta varje värde i <code>new_vector</code> i kvadrat, <em>sedan</em> summera, och sedan ta roten ur.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="datahantering-och-grafer.html#cb30-1" tabindex="-1"></a>new_vector_squared <span class="ot">&lt;-</span> new_vector<span class="sc">^</span><span class="dv">2</span>     <span class="co"># Ta kvadraten av varje värde</span></span>
<span id="cb30-2"><a href="datahantering-och-grafer.html#cb30-2" tabindex="-1"></a>new_vector_squared_sum <span class="ot">&lt;-</span> <span class="fu">sum</span>(___)     <span class="co"># Summera vektorn med kvadrater</span></span>
<span id="cb30-3"><a href="datahantering-och-grafer.html#cb30-3" tabindex="-1"></a><span class="fu">sqrt</span>(___)                              <span class="co"># Ta kvadratroten ur summan</span></span></code></pre></div>
</div>
<p>Ett alternativ till att spara utfallet i varje steg är att skriva en senare funktion <em>runt</em> en tidigare funktion. Det fungerar för att R utvärderar funktioner inifrån-ut. Med samma exempel som tidigare får man</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="datahantering-och-grafer.html#cb31-1" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">abs</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="sc">-</span><span class="dv">2</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>)))       <span class="co"># Ta summan av absolutvärden av vektorn</span></span></code></pre></div>
<p>medan beräkningen i övningen blir</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="datahantering-och-grafer.html#cb32-1" tabindex="-1"></a><span class="fu">sqrt</span>(<span class="fu">sum</span>(new_vector<span class="sc">^</span><span class="dv">2</span>))                <span class="co"># Ta roten ur summan av vektorn i kvadrat</span></span></code></pre></div>
<p>Den här typen av skrivning kan spara plats men blir snabbt svårläst.</p>
<p>Ett sista alternativ är att använda en så kallad <em>pipe</em> (namnet kommer från att en sekvens funktioner kallas en <em>pipeline</em>). En pipe skrivs <code>%&gt;%</code> och kan i RStudio tas fram med kortkommandon <em>Ctrl + Shift + M</em>. Pipen tar utfallet av en funktion till vänster och sänder till en funktion till höger. Den kan utläsas i dagligt tal som <em>och sen</em>. Med samma exempel som tidigare kan vi skriva</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="datahantering-och-grafer.html#cb33-1" tabindex="-1"></a><span class="fu">library</span>(tidyverse)                     <span class="co"># Ladda tidyverse, ej nödvändigt om redan gjort</span></span>
<span id="cb33-2"><a href="datahantering-och-grafer.html#cb33-2" tabindex="-1"></a></span>
<span id="cb33-3"><a href="datahantering-och-grafer.html#cb33-3" tabindex="-1"></a><span class="fu">c</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="sc">-</span><span class="dv">2</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>) <span class="sc">%&gt;%</span>             <span class="co"># Skapa en datamängd och sen</span></span>
<span id="cb33-4"><a href="datahantering-och-grafer.html#cb33-4" tabindex="-1"></a>  <span class="fu">abs</span>() <span class="sc">%&gt;%</span>                            <span class="co"># ta absolutvärden, och sen</span></span>
<span id="cb33-5"><a href="datahantering-och-grafer.html#cb33-5" tabindex="-1"></a>  <span class="fu">sum</span>()                                <span class="co"># beräkna summan.</span></span></code></pre></div>
<pre><code>## [1] 14</code></pre>
<div class="exercise">
<p><span id="exr:unlabeled-div-11" class="exercise"><strong>Uppgift 1.11  (Kvadrat, summa och rot med pipe) </strong></span>Fyll i de saknade funktionerna och kör följande rader för att ta varje värde i <code>new_vector</code> i kvadrat, <em>sedan</em> summera, och sedan ta roten ur, denna gång genom att länka funktionerna med en pipe <code>%&gt;%</code>.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="datahantering-och-grafer.html#cb35-1" tabindex="-1"></a>new_vector<span class="sc">^</span><span class="dv">2</span> <span class="sc">%&gt;%</span>                       <span class="co"># Ta kvadraterna av new_vector, och sen</span></span>
<span id="cb35-2"><a href="datahantering-och-grafer.html#cb35-2" tabindex="-1"></a>  <span class="fu">___</span>() <span class="sc">%&gt;%</span>                            <span class="co"># beräkna summan, och sen</span></span>
<span id="cb35-3"><a href="datahantering-och-grafer.html#cb35-3" tabindex="-1"></a>  <span class="fu">____</span>()                               <span class="co"># Ta kvadratroten med sqrt()</span></span></code></pre></div>
</div>
</div>
<div id="datainskrivning-och-dataimport-från-web" class="section level2 hasAnchor" number="1.5">
<h2><span class="header-section-number">1.5</span> Datainskrivning och dataimport från web<a href="datahantering-och-grafer.html#datainskrivning-och-dataimport-från-web" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="inskrivning-av-data" class="section level3 hasAnchor" number="1.5.1">
<h3><span class="header-section-number">1.5.1</span> Inskrivning av data<a href="datahantering-och-grafer.html#inskrivning-av-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Det första praktiska steget i en statistisk analys är att importera data. I R kan det göras genom att direkt skriva in sin data och spara som ett nytt objekt, men ett bättre och vanligare sätt är att importera sin data från en extern fil eller databas.</p>
<p>I ett tidigare exempel användes funktionen <code>c()</code> för att skapa en vektor av data. Ofta ordnas flera vektorer i en tabell där varje kolumn är en vektor och varje rad en observation av någon enhet. En datatabell (en <code>data.frame</code> i R) skapas genom funktionen <code>data.frame()</code> följt av namngivna vektorer. Exempeldata kan skrivas in genom föjande.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="datahantering-och-grafer.html#cb36-1" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Vecka =</span> <span class="fu">c</span>(<span class="dv">7</span>,<span class="dv">7</span>,<span class="dv">7</span>,<span class="dv">7</span>,<span class="dv">7</span>,<span class="dv">7</span>,<span class="dv">11</span>,<span class="dv">11</span>,<span class="dv">11</span>,<span class="dv">11</span>,<span class="dv">11</span>,<span class="dv">11</span>),</span>
<span id="cb36-2"><a href="datahantering-och-grafer.html#cb36-2" tabindex="-1"></a>                  <span class="at">Behandling =</span> <span class="fu">c</span>(<span class="st">&quot;A&quot;</span>,<span class="st">&quot;A&quot;</span>,<span class="st">&quot;A&quot;</span>,<span class="st">&quot;B&quot;</span>,<span class="st">&quot;B&quot;</span>,<span class="st">&quot;B&quot;</span>,<span class="st">&quot;A&quot;</span>,<span class="st">&quot;A&quot;</span>,<span class="st">&quot;A&quot;</span>,<span class="st">&quot;B&quot;</span>,<span class="st">&quot;B&quot;</span>,<span class="st">&quot;B&quot;</span>),</span>
<span id="cb36-3"><a href="datahantering-och-grafer.html#cb36-3" tabindex="-1"></a>                  <span class="at">Vikt =</span> <span class="fu">c</span>(<span class="dv">232</span>,<span class="dv">161</span>,<span class="dv">148</span>,<span class="dv">368</span>,<span class="dv">218</span>,<span class="dv">257</span>,<span class="dv">1633</span>,<span class="dv">2213</span>,<span class="dv">972</span>,<span class="dv">2560</span>,<span class="dv">2430</span>,<span class="dv">855</span>),</span>
<span id="cb36-4"><a href="datahantering-och-grafer.html#cb36-4" tabindex="-1"></a>                  <span class="at">N =</span> <span class="fu">c</span>(<span class="fl">2.63</span>,<span class="fl">2.90</span>,<span class="fl">2.99</span>,<span class="fl">3.54</span>,<span class="fl">3.30</span>,<span class="fl">2.85</span>,<span class="fl">1.53</span>,<span class="fl">1.90</span>,<span class="cn">NA</span>,<span class="fl">2.58</span>,<span class="cn">NA</span>,<span class="cn">NA</span>))</span>
<span id="cb36-5"><a href="datahantering-och-grafer.html#cb36-5" tabindex="-1"></a>dat</span></code></pre></div>
<pre><code>##    Vecka Behandling Vikt    N
## 1      7          A  232 2.63
## 2      7          A  161 2.90
## 3      7          A  148 2.99
## 4      7          B  368 3.54
## 5      7          B  218 3.30
## 6      7          B  257 2.85
## 7     11          A 1633 1.53
## 8     11          A 2213 1.90
## 9     11          A  972   NA
## 10    11          B 2560 2.58
## 11    11          B 2430   NA
## 12    11          B  855   NA</code></pre>
<p>Radbrytningar och blanksteg är oviktiga i R, och används bara för läsbarhet här. Saknade värden skrivs in som <code>NA</code> för <em>not available</em>. Notera att alla kolumner inte behöver vara av samma datatyp men att värden inom en kolumn måste vara det. Här är <em>Behandling</em> text medan övriga kolumner är numeriska.</p>
<div class="exercise">
<p><span id="exr:unlabeled-div-12" class="exercise"><strong>Uppgift 1.12  (Alea iacta est) </strong></span>Kasta din tärning tio gånger och skriv in resultatet i en datatabell i R med hjälp av grundkoden nedan. Om du saknar en tärning, fråga lämplig person om du kan få en. Behåll tärningen, den behövs till nästa datorövning (och närhelst man står inför ett avgörande livsbeslut).</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="datahantering-och-grafer.html#cb38-1" tabindex="-1"></a>dat_dice <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Kast =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>,<span class="dv">10</span>),</span>
<span id="cb38-2"><a href="datahantering-och-grafer.html#cb38-2" tabindex="-1"></a>                       <span class="at">Utfall =</span> <span class="fu">c</span>(_,_,_,_,_,_,_,_,_,_))</span>
<span id="cb38-3"><a href="datahantering-och-grafer.html#cb38-3" tabindex="-1"></a>dat_dice</span></code></pre></div>
</div>
<p>Objektet <code>dat</code> är av typen <code>data.frame</code> - en tabell med rader och kolumner. Man kan ange en specifik kolumn i en data.frame med dollartecken följt av kolumnens namn.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="datahantering-och-grafer.html#cb39-1" tabindex="-1"></a>dat<span class="sc">$</span>Vikt</span></code></pre></div>
<pre><code>##  [1]  232  161  148  368  218  257 1633 2213  972 2560 2430  855</code></pre>
<p>Man kan också plocka ut rader och kolumner med hakparenteser och ordningstal.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="datahantering-och-grafer.html#cb41-1" tabindex="-1"></a>dat[<span class="dv">2</span>,<span class="dv">3</span>]          <span class="co"># Andra raden och tredje kolumnen</span></span></code></pre></div>
<pre><code>## [1] 161</code></pre>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="datahantering-och-grafer.html#cb43-1" tabindex="-1"></a>dat[<span class="dv">2</span>, ]           <span class="co"># Tomt värde ger alla värden. Här alla värden i rad 2</span></span></code></pre></div>
<pre><code>##   Vecka Behandling Vikt   N
## 2     7          A  161 2.9</code></pre>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="datahantering-och-grafer.html#cb45-1" tabindex="-1"></a>dat[ ,<span class="dv">3</span>]           <span class="co"># Alla värden i kolumn 3</span></span></code></pre></div>
<pre><code>##  [1]  232  161  148  368  218  257 1633 2213  972 2560 2430  855</code></pre>
<div class="exercise">
<p><span id="exr:unlabeled-div-13" class="exercise"><strong>Uppgift 1.13  (Plocka ut en specifik kolumn) </strong></span>I den tidigare övningen skapade du ett objekt <code>dat_dice</code>. Använd dollartecken för att plocka ut kolumnen <em>Utfall</em> från det objektet.</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="datahantering-och-grafer.html#cb47-1" tabindex="-1"></a>dat_dice<span class="sc">$</span>___</span></code></pre></div>
</div>
<p>Genom att plocka ut en kolumn från en data.frame kan man beräkna vanlig beskrivande statistik med funktioner som <code>mean()</code> (medelvärde) och <code>sd()</code> (standardavvikelsen).</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="datahantering-och-grafer.html#cb48-1" tabindex="-1"></a><span class="fu">mean</span>(dat<span class="sc">$</span>Vikt)</span></code></pre></div>
<pre><code>## [1] 1003.917</code></pre>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="datahantering-och-grafer.html#cb50-1" tabindex="-1"></a><span class="fu">sd</span>(dat<span class="sc">$</span>Vikt)</span></code></pre></div>
<pre><code>## [1] 951.3067</code></pre>
<p>Funktionen <code>plot()</code> ger en enkel graf.</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="datahantering-och-grafer.html#cb52-1" tabindex="-1"></a><span class="fu">plot</span>(dat<span class="sc">$</span>Vecka, dat<span class="sc">$</span>Vikt)</span></code></pre></div>
<p><img src="R-anvisningar_files/figure-html/unnamed-chunk-36-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="exercise">
<p><span id="exr:unlabeled-div-14" class="exercise"><strong>Uppgift 1.14  (Alea iacta est) </strong></span>Använd datan i objektet <code>dat_dice</code> och skapa ett diagram med kolumnen kast på x-axeln och kolumnen Utfall på y-axeln.</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="datahantering-och-grafer.html#cb53-1" tabindex="-1"></a><span class="fu">plot</span>(dat_dice<span class="sc">$</span>___, dat_dice<span class="sc">$</span>___)</span></code></pre></div>
</div>
</div>
<div id="import-från-en-extern-fil" class="section level3 hasAnchor" number="1.5.2">
<h3><span class="header-section-number">1.5.2</span> Import från en extern fil<a href="datahantering-och-grafer.html#import-från-en-extern-fil" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Inskrivning av värden är ofta tidskrävande och kan lätt leda till misstag. Det är därför mycket vanligare att data läses in från en extern fil. Det finns en mängd funktioner för dataimport och det exakta valet av funktion beror på vilken typ av fil datan är sparad i. Ett vanligt filformat är .csv (<em>comma separated values</em>). Här importerar vi en fil med data från Spotify. Filen ligger på Github, en populär sida för lagring av filer och kod.</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="datahantering-och-grafer.html#cb54-1" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;https://raw.githubusercontent.com/adamflr/ST0060-2023/master/Data/Spotify_data.csv&quot;</span>) </span>
<span id="cb54-2"><a href="datahantering-och-grafer.html#cb54-2" tabindex="-1"></a>                                       <span class="co"># Läs in en csv-fil från Github</span></span>
<span id="cb54-3"><a href="datahantering-och-grafer.html#cb54-3" tabindex="-1"></a>dat                                    <span class="co"># Skriv ut objektet dat</span></span></code></pre></div>
<pre><code>## # A tibble: 89,105 × 24
##    artist_name album_name  track_number track_name album_type album_release_date
##    &lt;chr&gt;       &lt;chr&gt;              &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;             
##  1 100 gecs    1000 gecs …            1 money mac… album      2020-07-10        
##  2 100 gecs    1000 gecs …            2 ringtone … album      2020-07-10        
##  3 100 gecs    1000 gecs …            3 745 stick… album      2020-07-10        
##  4 100 gecs    1000 gecs …            4 gec 2 Ü (… album      2020-07-10        
##  5 100 gecs    1000 gecs …            5 hand crus… album      2020-07-10        
##  6 100 gecs    1000 gecs …            6 800db clo… album      2020-07-10        
##  7 100 gecs    1000 gecs …            7 stupid ho… album      2020-07-10        
##  8 100 gecs    1000 gecs …            8 ringtone … album      2020-07-10        
##  9 100 gecs    1000 gecs …            9 xXXi_wud_… album      2020-07-10        
## 10 100 gecs    1000 gecs …           10 745 stick… album      2020-07-10        
## # ℹ 89,095 more rows
## # ℹ 18 more variables: album_release_year &lt;dbl&gt;, danceability &lt;dbl&gt;,
## #   energy &lt;dbl&gt;, key &lt;dbl&gt;, loudness &lt;dbl&gt;, mode &lt;dbl&gt;, speechiness &lt;dbl&gt;,
## #   acousticness &lt;dbl&gt;, instrumentalness &lt;dbl&gt;, liveness &lt;dbl&gt;, valence &lt;dbl&gt;,
## #   tempo &lt;dbl&gt;, time_signature &lt;dbl&gt;, explicit &lt;lgl&gt;, type &lt;chr&gt;,
## #   key_name &lt;chr&gt;, mode_name &lt;chr&gt;, key_mode &lt;chr&gt;</code></pre>
<p>Om importen fungerat kan man skriva ut tabellens översta rader genom att köra objektets namn.</p>
<p>För att snabbt se vilka artister datan täcker kan man köra</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="datahantering-och-grafer.html#cb56-1" tabindex="-1"></a><span class="fu">unique</span>(dat<span class="sc">$</span>artist_name)                <span class="co"># Skriv ut unika värden i kolumnen artist_name i dat</span></span></code></pre></div>
<p>där <code>unique</code> är en funktion som tar bort alla dubletter och <code>dat$artist_name</code> används för att plocka ut kolumnen <code>artist_name</code> ur tabellen <code>dat</code>.</p>
</div>
</div>
<div id="urval-ur-en-tabell-med-select-och-filter" class="section level2 hasAnchor" number="1.6">
<h2><span class="header-section-number">1.6</span> Urval ur en tabell med <code>select</code> och <code>filter</code><a href="datahantering-och-grafer.html#urval-ur-en-tabell-med-select-och-filter" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>En vanlig operation på en tabell är att göra ett urval - antingen ett urval av rader (t.ex. en viss artist), vilket kallas <em>filtrering</em> eller ett urval av variabler (t.ex. artist och albumnamn), vilket kallas <em>selektion</em>. Här tittar vi på hur det kan göras med funktionerna <code>filter()</code> och <code>select()</code> från paketet <code>tidyverse</code>.</p>
<p>För att filtrera på en given artist kan man använda pipe-funktionen från datan till en filter-funktion, t.ex.</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="datahantering-och-grafer.html#cb57-1" tabindex="-1"></a>dat <span class="sc">%&gt;%</span>                                <span class="co"># Ta spotify-datan och sen</span></span>
<span id="cb57-2"><a href="datahantering-och-grafer.html#cb57-2" tabindex="-1"></a>  <span class="fu">filter</span>(artist_name <span class="sc">==</span> <span class="st">&quot;Robyn&quot;</span>)       <span class="co"># filtrera för en specifik artist</span></span></code></pre></div>
<pre><code>## # A tibble: 1,141 × 24
##    artist_name album_name track_number track_name  album_type album_release_date
##    &lt;chr&gt;       &lt;chr&gt;             &lt;dbl&gt; &lt;chr&gt;       &lt;chr&gt;      &lt;chr&gt;             
##  1 Robyn       Honey                 1 Missing U   album      2018-10-26        
##  2 Robyn       Honey                 2 Human Being album      2018-10-26        
##  3 Robyn       Honey                 3 Because It… album      2018-10-26        
##  4 Robyn       Honey                 4 Baby Forgi… album      2018-10-26        
##  5 Robyn       Honey                 5 Send To Ro… album      2018-10-26        
##  6 Robyn       Honey                 6 Honey       album      2018-10-26        
##  7 Robyn       Honey                 7 Between Th… album      2018-10-26        
##  8 Robyn       Honey                 8 Beach2k20   album      2018-10-26        
##  9 Robyn       Honey                 9 Ever Again  album      2018-10-26        
## 10 Robyn       Honey                 1 Missing U   album      2018-10-26        
## # ℹ 1,131 more rows
## # ℹ 18 more variables: album_release_year &lt;dbl&gt;, danceability &lt;dbl&gt;,
## #   energy &lt;dbl&gt;, key &lt;dbl&gt;, loudness &lt;dbl&gt;, mode &lt;dbl&gt;, speechiness &lt;dbl&gt;,
## #   acousticness &lt;dbl&gt;, instrumentalness &lt;dbl&gt;, liveness &lt;dbl&gt;, valence &lt;dbl&gt;,
## #   tempo &lt;dbl&gt;, time_signature &lt;dbl&gt;, explicit &lt;lgl&gt;, type &lt;chr&gt;,
## #   key_name &lt;chr&gt;, mode_name &lt;chr&gt;, key_mode &lt;chr&gt;</code></pre>
<p>Inom filterfunktionen anges ett logisk villkor <code>artist_name == "Robyn"</code> och utfallet är de rader där villkoret är sant. Notera de dubbla likhetstecknen - de måste användas för ett logisk villkor eftersom enkelt likhetstecken används för att skapa objekt och sätta funktionsargument.</p>
<div class="exercise">
<p><span id="exr:unlabeled-div-15" class="exercise"><strong>Uppgift 1.15  (Filtrera för artist) </strong></span>Vad måste ändras i koden för att istället plocka ut rader där artisten är Esperanza Spalding? Hur många rader har det urvalet i datan?</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="datahantering-och-grafer.html#cb59-1" tabindex="-1"></a>dat <span class="sc">%&gt;%</span>                                <span class="co"># Ta spotify-datan och sen</span></span>
<span id="cb59-2"><a href="datahantering-och-grafer.html#cb59-2" tabindex="-1"></a>  <span class="fu">filter</span>(artist_name <span class="sc">==</span> <span class="st">&quot;Robyn&quot;</span>)       <span class="co"># filtrera för en specifik artist</span></span></code></pre></div>
</div>
<p>Om man vill välja flera artister kan man använda funktionen <code>%in%</code> på ett liknande sätt.</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="datahantering-och-grafer.html#cb60-1" tabindex="-1"></a>dat <span class="sc">%&gt;%</span>                                                              <span class="co"># Ta datan, och sen</span></span>
<span id="cb60-2"><a href="datahantering-och-grafer.html#cb60-2" tabindex="-1"></a>  <span class="fu">filter</span>(artist_name <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Robyn&quot;</span>, <span class="st">&quot;Esperanza Spalding&quot;</span>))          <span class="co"># filtrera för specifika artister</span></span></code></pre></div>
<p>och om man vill ha mer än ett villkor kan man rada dem i filter-funktionen:</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="datahantering-och-grafer.html#cb61-1" tabindex="-1"></a>dat <span class="sc">%&gt;%</span>                                                              <span class="co"># Ta datan, och sen</span></span>
<span id="cb61-2"><a href="datahantering-och-grafer.html#cb61-2" tabindex="-1"></a>  <span class="fu">filter</span>(artist_name <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Robyn&quot;</span>, <span class="st">&quot;Esperanza Spalding&quot;</span>),          <span class="co"># filtrera för specifika artister</span></span>
<span id="cb61-3"><a href="datahantering-och-grafer.html#cb61-3" tabindex="-1"></a>         key_name <span class="sc">==</span> <span class="st">&quot;D#&quot;</span>)                                           <span class="co"># och för tonart</span></span></code></pre></div>
<p>För att se fler eller färre rader kan man använda en pipe <code>%&gt;%</code> till funktionen <code>print()</code>. Följande skriver ut fem rader</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="datahantering-och-grafer.html#cb62-1" tabindex="-1"></a>dat <span class="sc">%&gt;%</span>                                                              <span class="co"># Ta datan, och sen</span></span>
<span id="cb62-2"><a href="datahantering-och-grafer.html#cb62-2" tabindex="-1"></a>  <span class="fu">filter</span>(artist_name <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Robyn&quot;</span>, <span class="st">&quot;Esperanza Spalding&quot;</span>)) <span class="sc">%&gt;%</span>      <span class="co"># filtrera för artister, och sen</span></span>
<span id="cb62-3"><a href="datahantering-och-grafer.html#cb62-3" tabindex="-1"></a>  <span class="fu">filter</span>(key_name <span class="sc">==</span> <span class="st">&quot;D#&quot;</span>)  <span class="sc">%&gt;%</span>                                      <span class="co"># filtrera för tonart, och sen</span></span>
<span id="cb62-4"><a href="datahantering-och-grafer.html#cb62-4" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">5</span>)                                                       <span class="co"># skriv ut de fem första raderna</span></span></code></pre></div>
<pre><code>## # A tibble: 21 × 24
##   artist_name   album_name track_number track_name album_type album_release_date
##   &lt;chr&gt;         &lt;chr&gt;             &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;             
## 1 Esperanza Sp… SONGWRIGH…            7 Formwela 7 album      2021-09-24        
## 2 Esperanza Sp… 12 Little…            2 To Tide U… album      2019-05-10        
## 3 Esperanza Sp… 12 Little…            3 &#39;Til the … album      2019-05-10        
## 4 Esperanza Sp… Emily’s D…            7 Ebony And… album      2016-01-01        
## 5 Esperanza Sp… Emily’s D…            7 Ebony And… album      2016-01-01        
## # ℹ 16 more rows
## # ℹ 18 more variables: album_release_year &lt;dbl&gt;, danceability &lt;dbl&gt;,
## #   energy &lt;dbl&gt;, key &lt;dbl&gt;, loudness &lt;dbl&gt;, mode &lt;dbl&gt;, speechiness &lt;dbl&gt;,
## #   acousticness &lt;dbl&gt;, instrumentalness &lt;dbl&gt;, liveness &lt;dbl&gt;, valence &lt;dbl&gt;,
## #   tempo &lt;dbl&gt;, time_signature &lt;dbl&gt;, explicit &lt;lgl&gt;, type &lt;chr&gt;,
## #   key_name &lt;chr&gt;, mode_name &lt;chr&gt;, key_mode &lt;chr&gt;</code></pre>
<p>Om man istället vill göra ett urval av kolumner kan man använda <code>select()</code>. Som argument anges de kolumner man vill välja, t.ex.</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="datahantering-och-grafer.html#cb64-1" tabindex="-1"></a>dat <span class="sc">%&gt;%</span>                                <span class="co"># Ta datan, och sen</span></span>
<span id="cb64-2"><a href="datahantering-och-grafer.html#cb64-2" tabindex="-1"></a>  <span class="fu">select</span>(artist_name, album_name)      <span class="co"># välj kolumnerna artist_name och album_name</span></span></code></pre></div>
<pre><code>## # A tibble: 89,105 × 2
##    artist_name album_name                     
##    &lt;chr&gt;       &lt;chr&gt;                          
##  1 100 gecs    1000 gecs and The Tree of Clues
##  2 100 gecs    1000 gecs and The Tree of Clues
##  3 100 gecs    1000 gecs and The Tree of Clues
##  4 100 gecs    1000 gecs and The Tree of Clues
##  5 100 gecs    1000 gecs and The Tree of Clues
##  6 100 gecs    1000 gecs and The Tree of Clues
##  7 100 gecs    1000 gecs and The Tree of Clues
##  8 100 gecs    1000 gecs and The Tree of Clues
##  9 100 gecs    1000 gecs and The Tree of Clues
## 10 100 gecs    1000 gecs and The Tree of Clues
## # ℹ 89,095 more rows</code></pre>
<p>Som avslutning ges ett lite mer komplicerat exempel på ett urval av artist, år och spår för spår med ett tempo över 180 bpm släppta under 2015.</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="datahantering-och-grafer.html#cb66-1" tabindex="-1"></a>dat <span class="sc">%&gt;%</span>                                                    <span class="co"># Ta datan och sen</span></span>
<span id="cb66-2"><a href="datahantering-och-grafer.html#cb66-2" tabindex="-1"></a>  <span class="fu">filter</span>(album_release_year <span class="sc">==</span> <span class="dv">2015</span>,                       <span class="co"># filtrera för rader där år är 2015, och </span></span>
<span id="cb66-3"><a href="datahantering-och-grafer.html#cb66-3" tabindex="-1"></a>         tempo <span class="sc">&gt;</span> <span class="dv">180</span>) <span class="sc">%&gt;%</span>                                  <span class="co"># tempot över 160, och sen</span></span>
<span id="cb66-4"><a href="datahantering-och-grafer.html#cb66-4" tabindex="-1"></a>  <span class="fu">select</span>(artist_name, album_release_year, track_name)      <span class="co"># selektera på artist, år och spår</span></span></code></pre></div>
<pre><code>## # A tibble: 129 × 3
##    artist_name            album_release_year track_name                         
##    &lt;chr&gt;                               &lt;dbl&gt; &lt;chr&gt;                              
##  1 A Sunny Day In Glasgow               2015 The Strange Presents of Idols (Mer…
##  2 A$AP Rocky                           2015 Lord Pretty Flacko Jodye 2 (LPFJ2) 
##  3 A$AP Rocky                           2015 Lord Pretty Flacko Jodye 2 (LPFJ2) 
##  4 Anderson .Paak                       2015 Off the Ground                     
##  5 Arcangel                             2015 50 Sombras De Austin               
##  6 Arcangel                             2015 50 Sombras de Austin               
##  7 Arcangel                             2015 50 Sombras de Austin               
##  8 Arcangel                             2015 50 Sombras de Austin               
##  9 Björk                                2015 Notget - Live                      
## 10 Björk                                2015 Notget                             
## # ℹ 119 more rows</code></pre>
<div class="exercise">
<p><span id="exr:unlabeled-div-16" class="exercise"><strong>Uppgift 1.16  (Snabba spår) </strong></span>Funktionen <code>arrange()</code> sorterar data efter en angiven kolumn. Följande stycke ger oss Björks snabbaste spår.</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="datahantering-och-grafer.html#cb68-1" tabindex="-1"></a>dat <span class="sc">%&gt;%</span>                                                    <span class="co"># Ta datan, och sen</span></span>
<span id="cb68-2"><a href="datahantering-och-grafer.html#cb68-2" tabindex="-1"></a>  <span class="fu">filter</span>(artist_name <span class="sc">==</span> <span class="st">&quot;Björk&quot;</span>) <span class="sc">%&gt;%</span>                       <span class="co"># filtrera för rader där artist är Björk, och sen</span></span>
<span id="cb68-3"><a href="datahantering-och-grafer.html#cb68-3" tabindex="-1"></a>  <span class="fu">select</span>(artist_name, album_name, track_name, tempo) <span class="sc">%&gt;%</span>   <span class="co"># välj kolumner med artist, album, spår och tempo, och sen</span></span>
<span id="cb68-4"><a href="datahantering-och-grafer.html#cb68-4" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="sc">-</span>tempo)                                          <span class="co"># ordna efter tempo (minus för fallande ordning)</span></span></code></pre></div>
<p>Gör lämpliga ändringar för att hitta Kate Bushs snabbaste spår.</p>
</div>
</div>
<div id="grafer-med-ggplot2" class="section level2 hasAnchor" number="1.7">
<h2><span class="header-section-number">1.7</span> Grafer med <code>ggplot2</code><a href="datahantering-och-grafer.html#grafer-med-ggplot2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Vi kan nu börja titta på grafer. Eftersom spotify-datan är ganska stor och grafer lätt blir oöversiktliga, börjar vi med att skapa en lite mindre datamängd.</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="datahantering-och-grafer.html#cb69-1" tabindex="-1"></a>dat_small <span class="ot">&lt;-</span> dat <span class="sc">%&gt;%</span>                                      <span class="co"># Ta data, och sen</span></span>
<span id="cb69-2"><a href="datahantering-och-grafer.html#cb69-2" tabindex="-1"></a>  <span class="fu">filter</span>(artist_name <span class="sc">==</span> <span class="st">&quot;Robyn&quot;</span>, album_type <span class="sc">==</span> <span class="st">&quot;album&quot;</span>)   <span class="co"># filtrera på artist och albumtyp</span></span></code></pre></div>
<div class="exercise">
<p><span id="exr:unlabeled-div-17" class="exercise"><strong>Uppgift 1.17  (Valfritt artistbyte) </strong></span>Om du vill titta på data för någon annan artist, gör lämplig ändring i stycket ovan. Kom ihåg att man kan skriva ut artister i datan med <code>unique(dat$artist_name)</code>.</p>
</div>
<p>R har en mängd grundläggande funktioner för grafer. Vi såg tidigare ett exempel på funktionen <code>plot()</code>.</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="datahantering-och-grafer.html#cb70-1" tabindex="-1"></a><span class="fu">plot</span>(dat_small<span class="sc">$</span>tempo, dat_small<span class="sc">$</span>danceability)   <span class="co"># Plotta en graf med tempo och dansbarhet på axlarna</span></span></code></pre></div>
<p><img src="R-anvisningar_files/figure-html/unnamed-chunk-49-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Tecknet <code>$</code> används här för att välja kolumnerna tempo och danceability ur objektet <code>dat_small</code>.</p>
<p>För mer avancerade grafer används dock ofta funktioner ur Rs paketbibliotek. Här illustreras det mest populära - <code>ggplot2</code>. I <code>ggplot2</code> byggs grafer upp med tre grundläggande byggstenar:</p>
<ul>
<li><em>data</em>, informationen man vill visualisera,</li>
<li><em>aestethics</em>, en koppling mellan data och visuella element såsom grafens axlar, objekts storlek och färg,</li>
<li><em>geometries</em>, de geometriska former som visas i grafen.</li>
</ul>
<p>En graf skrivs med en startfunktion <code>ggplot</code> som anger namnet på datan och grafens <em>aestethics</em>, och därefter sätts geometriska element genom funktioner som börjar med <code>geom_</code>. Ett spridningsdiagram kan t.ex. skapas med <code>geom_point</code>.</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="datahantering-och-grafer.html#cb71-1" tabindex="-1"></a><span class="fu">ggplot</span>(dat_small, <span class="fu">aes</span>(<span class="at">x =</span> tempo, <span class="at">y =</span> danceability)) <span class="sc">+</span>  <span class="co"># Ta datan, koppla tempo och dansbarhet till x och y</span></span>
<span id="cb71-2"><a href="datahantering-och-grafer.html#cb71-2" tabindex="-1"></a>  <span class="fu">geom_point</span>()                                         <span class="co"># och illustrera varje observation med punkt</span></span></code></pre></div>
<p><img src="R-anvisningar_files/figure-html/unnamed-chunk-50-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Grafen kan byggas ut genom att sätta <em>aestethics</em> för färg och storlek. Man kan också dela en graf i småfönster med <code>facet_wrap</code> och styra grafens utseende genom att sätta ett tema såsom <code>theme_bw</code>.</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="datahantering-och-grafer.html#cb72-1" tabindex="-1"></a><span class="fu">ggplot</span>(dat_small, <span class="fu">aes</span>(<span class="at">x =</span> tempo, <span class="at">y =</span> danceability, <span class="at">color =</span> mode_name)) <span class="sc">+</span>   <span class="co"># Ta datan, koppla tempo, dansbarhet och tonart till axlarna respektive färg</span></span>
<span id="cb72-2"><a href="datahantering-och-grafer.html#cb72-2" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span>                                                           <span class="co"># Illustrera med punkter</span></span>
<span id="cb72-3"><a href="datahantering-och-grafer.html#cb72-3" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> album_name)                                                 <span class="co"># Skapa småfönster efter album</span></span></code></pre></div>
<p><img src="R-anvisningar_files/figure-html/unnamed-chunk-51-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="exercise">
<p><span id="exr:unlabeled-div-18" class="exercise"><strong>Uppgift 1.18  (Dur och moll) </strong></span>Vad ska ändras i stycket nedan för att skapa en graf med dur/moll (<code>mode_name</code>) på x-axeln, valens (<code>valence</code>) på y-axeln och skilda småfönster för olika år (<code>album_release_year</code>)?</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="datahantering-och-grafer.html#cb73-1" tabindex="-1"></a><span class="fu">ggplot</span>(dat_small, <span class="fu">aes</span>(<span class="at">x =</span> ____, <span class="at">y =</span> ____, <span class="at">color =</span> album_name)) <span class="sc">+</span> <span class="co"># Ta datan och koppla variabler till egenskaper</span></span>
<span id="cb73-2"><a href="datahantering-och-grafer.html#cb73-2" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span>                                                 <span class="co"># Illustrera med punkter</span></span>
<span id="cb73-3"><a href="datahantering-och-grafer.html#cb73-3" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> album_release_year)                               <span class="co"># Skapa småfönster efter år</span></span></code></pre></div>
<p>Har spår i dur (<em>major</em>) högre valens?</p>
</div>
<p>Andra graftyper kan skapas med andra <code>geom_</code>-funktioner. Stapeldiagram ges av <code>geom_col</code> (<code>col</code> för <em>column</em>). Man kan också använda <code>geom_bar</code> om man bara vill räkna antal rader per någon kategori.
Följande väljer ut en artist och plottar spårens dansbarhet i ett (liggande) stapeldiagram.</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="datahantering-och-grafer.html#cb74-1" tabindex="-1"></a>dat_small <span class="ot">&lt;-</span> dat <span class="sc">%&gt;%</span> </span>
<span id="cb74-2"><a href="datahantering-och-grafer.html#cb74-2" tabindex="-1"></a>  <span class="fu">filter</span>(artist_name <span class="sc">==</span> <span class="st">&quot;HAIM&quot;</span>, album_type <span class="sc">==</span> <span class="st">&quot;album&quot;</span>)</span>
<span id="cb74-3"><a href="datahantering-och-grafer.html#cb74-3" tabindex="-1"></a></span>
<span id="cb74-4"><a href="datahantering-och-grafer.html#cb74-4" tabindex="-1"></a><span class="fu">ggplot</span>(dat_small, <span class="fu">aes</span>(danceability, track_name, <span class="at">fill =</span> album_name)) <span class="sc">+</span></span>
<span id="cb74-5"><a href="datahantering-och-grafer.html#cb74-5" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">color =</span> <span class="st">&quot;black&quot;</span>)</span></code></pre></div>
<p><img src="R-anvisningar_files/figure-html/unnamed-chunk-53-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Argumentet <code>fill</code> styr färgen för ytor (här staplarnas ytor) medan <code>color</code> i <code>geom_col()</code> styr kanten runt varje stapel.</p>
<p>Man kan styra grafiken i en <code>ggplot</code> genom funktionen <code>theme()</code>. Det är ett ganska komplicerat ämne, men låt oss titta på några grunder. Vi börjar med att skapa en enkel graf: en boxplot över dansbarhet per album för bandet <em>Beach House</em>.</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="datahantering-och-grafer.html#cb75-1" tabindex="-1"></a>dat_small <span class="ot">&lt;-</span> dat <span class="sc">%&gt;%</span>                                            <span class="co"># Ta datan, och sen</span></span>
<span id="cb75-2"><a href="datahantering-och-grafer.html#cb75-2" tabindex="-1"></a>  <span class="fu">filter</span>(artist_name <span class="sc">==</span> <span class="st">&quot;Beach House&quot;</span>, album_type <span class="sc">==</span> <span class="st">&quot;album&quot;</span>)   <span class="co"># filtrera på artist och albumtyp</span></span>
<span id="cb75-3"><a href="datahantering-och-grafer.html#cb75-3" tabindex="-1"></a></span>
<span id="cb75-4"><a href="datahantering-och-grafer.html#cb75-4" tabindex="-1"></a><span class="fu">ggplot</span>(dat_small, <span class="fu">aes</span>(<span class="at">x =</span> danceability, <span class="at">y =</span> album_name)) <span class="sc">+</span>      <span class="co"># Ta data och koppla dansbarhet och album till axlarna</span></span>
<span id="cb75-5"><a href="datahantering-och-grafer.html#cb75-5" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()                                                <span class="co"># Illustrera med lådagram</span></span></code></pre></div>
<p><img src="R-anvisningar_files/figure-html/unnamed-chunk-54-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Vi kan ändra utseendet på grafen genom argument inom geometrier och med funktionen <code>theme()</code>. I <code>theme()</code> sätter man de specifika egenskaper man vill ändra genom att tillskriva dem ett <em>element</em>. Valet av element beror på typen av grafiskt objekt - text sätts t.ex. med <code>element_text()</code> och ytor med <code>element_rect()</code> (för <em>rectangle</em>). Vi ger ett exempel med ändrad bakgrund, rutmönster, och teckenstorlek.</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="datahantering-och-grafer.html#cb76-1" tabindex="-1"></a><span class="fu">ggplot</span>(dat_small, <span class="fu">aes</span>(danceability, album_name)) <span class="sc">+</span></span>
<span id="cb76-2"><a href="datahantering-och-grafer.html#cb76-2" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">fill =</span> <span class="st">&quot;lightblue&quot;</span>) <span class="sc">+</span>                                         <span class="co"># Fyll lådagrammen med en färg</span></span>
<span id="cb76-3"><a href="datahantering-och-grafer.html#cb76-3" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;red3&quot;</span>),                      <span class="co"># Sätt grafenfönstrets bakgrund</span></span>
<span id="cb76-4"><a href="datahantering-och-grafer.html#cb76-4" tabindex="-1"></a>        <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>, <span class="at">color =</span> <span class="st">&quot;white&quot;</span>, <span class="at">family =</span> <span class="st">&quot;serif&quot;</span>),   <span class="co"># Sätt textens storlek och snitt</span></span>
<span id="cb76-5"><a href="datahantering-och-grafer.html#cb76-5" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&quot;white&quot;</span>),                           <span class="co"># Sätt axel-textens färg</span></span>
<span id="cb76-6"><a href="datahantering-och-grafer.html#cb76-6" tabindex="-1"></a>        <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;grey30&quot;</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>),    <span class="co"># Sätt grafens bakgrund</span></span>
<span id="cb76-7"><a href="datahantering-och-grafer.html#cb76-7" tabindex="-1"></a>        <span class="at">panel.grid.major.y =</span> <span class="fu">element_blank</span>())                                <span class="co"># Sätt rutnätet till blankt</span></span></code></pre></div>
<p><img src="R-anvisningar_files/figure-html/unnamed-chunk-55-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="exercise">
<p><span id="exr:unlabeled-div-19" class="exercise"><strong>Uppgift 1.19  (Temaval 1) </strong></span>Ändra färgvalen i grafen ovan för att skapa snyggast möjliga graf. Funktionen <code>colors()</code> ger de färger som finns tillängliga i R. Man kan också använda hex-koden för färger, t.ex. <code>fill = "#ffdd00"</code>.</p>
</div>
<div class="exercise">
<p><span id="exr:unlabeled-div-20" class="exercise"><strong>Uppgift 1.20  (Temaval 2) </strong></span>Ändra färgvalen i grafen ovan för att skapa fulast möjliga graf. Visa de två graferna för någon annan och se om de kan säga vilken som är vilken.</p>
</div>
</div>
<div id="bonus.-interaktiva-grafer-med-plotly" class="section level2 hasAnchor" number="1.8">
<h2><span class="header-section-number">1.8</span> Bonus. Interaktiva grafer med <code>plotly</code><a href="datahantering-och-grafer.html#bonus.-interaktiva-grafer-med-plotly" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Låt oss ta en titt på <code>plotly</code>, ett av flera R-paket som gör det möjligt att skapa interaktiva grafer. Vi börjar med att installera och ladda paketet.</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="datahantering-och-grafer.html#cb77-1" tabindex="-1"></a><span class="co"># install.packages(&quot;plotly&quot;)                     # Installera plotly (ej nödvändigt om redan installerat)</span></span>
<span id="cb77-2"><a href="datahantering-och-grafer.html#cb77-2" tabindex="-1"></a><span class="fu">library</span>(plotly)                                  <span class="co"># Ladda plotly</span></span></code></pre></div>
<p>Paketet innehåller en smidig funktion <code>ggplotly()</code> för att göra en interaktiv graf från en <code>ggplot</code>. Vi börjar med att filtrera datan för en specifik artist och albumtyp. I samma pipe skapar vi en ny kolumn decade, som beräknar årtiondet utifrån året. Den exakta beräkning är inte så viktig, men ta gärna en titt och se om du förstår vad som delarna gör.</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="datahantering-och-grafer.html#cb78-1" tabindex="-1"></a>dat_small <span class="ot">&lt;-</span> dat <span class="sc">%&gt;%</span>                                                 <span class="co"># Ta datan, och sen</span></span>
<span id="cb78-2"><a href="datahantering-och-grafer.html#cb78-2" tabindex="-1"></a>  <span class="fu">filter</span>(artist_name <span class="sc">==</span> <span class="st">&quot;David Bowie&quot;</span>, album_type <span class="sc">==</span> <span class="st">&quot;album&quot;</span>) <span class="sc">%&gt;%</span>    <span class="co"># filtrera på artist och albumtyp, och sen</span></span>
<span id="cb78-3"><a href="datahantering-och-grafer.html#cb78-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Decade =</span> <span class="fu">floor</span>(album_release_year <span class="sc">/</span> <span class="dv">10</span>) <span class="sc">*</span> <span class="dv">10</span>)               <span class="co"># skapa en variable för årtionde.</span></span></code></pre></div>
<p>(Säg t.ex. att vi har året 1979. Att dela med 10 ger 197.9. Funktionen <code>floor</code> avrundar nedåt till 197. Multiplikationen med 10 ger 1970.)</p>
<p>Vi kan nu konstruera en graf med <code>ggplot()</code>. Låt oss ha dansbarhet på x-axeln och valens på y-axeln. Geomet <code>geom_point()</code> ger ett spridningdiagram och <code>facet_wrap(~ Decade)</code> delar i småfönster efter årtionde. Slutligen tar <code>theme(legend.position = "none")</code> bort <em>legenden</em> - guiden som anger vilken färg som är vilket album.</p>
<p>Notera att vi sparar grafen som ett objekt <code>g</code>. För att se grafen kör vi objektnamnet.</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="datahantering-och-grafer.html#cb79-1" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dat_small, <span class="fu">aes</span>(danceability, valence, <span class="at">color =</span> album_name, <span class="at">text =</span> track_name)) <span class="sc">+</span></span>
<span id="cb79-2"><a href="datahantering-och-grafer.html#cb79-2" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb79-3"><a href="datahantering-och-grafer.html#cb79-3" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> Decade) <span class="sc">+</span>            <span class="co"># Skapa småfönster per årtionde</span></span>
<span id="cb79-4"><a href="datahantering-och-grafer.html#cb79-4" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)   <span class="co"># Ta bort legenden (kopplingen mellan färg och album)</span></span>
<span id="cb79-5"><a href="datahantering-och-grafer.html#cb79-5" tabindex="-1"></a>g</span></code></pre></div>
<p>När vi har en färdig ggplot kan <code>ggplotly()</code> ge en interaktiv version av samma graf.</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="datahantering-och-grafer.html#cb80-1" tabindex="-1"></a><span class="fu">ggplotly</span>(g)</span></code></pre></div>
<div class="exercise">
<p><span id="exr:unlabeled-div-21" class="exercise"><strong>Uppgift 1.21  (Interaktiv graf med annan artist) </strong></span>Gör lämpliga ändringar i stycket nedan för att skapa en interaktiv graf med en annan artist och med tempo på x-axeln och dansbarhet på y-axeln. Kom ihåg att du kan se tillgängliga artister med raden <code>unique(dat$artist_name)</code>.</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="datahantering-och-grafer.html#cb81-1" tabindex="-1"></a>dat_small <span class="ot">&lt;-</span> dat <span class="sc">%&gt;%</span> </span>
<span id="cb81-2"><a href="datahantering-och-grafer.html#cb81-2" tabindex="-1"></a>  <span class="fu">filter</span>(artist_name <span class="sc">==</span> <span class="st">&quot;David Bowie&quot;</span>, album_type <span class="sc">==</span> <span class="st">&quot;album&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb81-3"><a href="datahantering-och-grafer.html#cb81-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Decade =</span> <span class="fu">floor</span>(album_release_year <span class="sc">/</span> <span class="dv">10</span>) <span class="sc">*</span> <span class="dv">10</span>)</span>
<span id="cb81-4"><a href="datahantering-och-grafer.html#cb81-4" tabindex="-1"></a></span>
<span id="cb81-5"><a href="datahantering-och-grafer.html#cb81-5" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dat_small, <span class="fu">aes</span>(danceability, valence, <span class="at">color =</span> album_name, <span class="at">text =</span> track_name)) <span class="sc">+</span></span>
<span id="cb81-6"><a href="datahantering-och-grafer.html#cb81-6" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span>                                 <span class="co"># Skapa punkter</span></span>
<span id="cb81-7"><a href="datahantering-och-grafer.html#cb81-7" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> Decade) <span class="sc">+</span>                         <span class="co"># Skapa småfönster per årtionde</span></span>
<span id="cb81-8"><a href="datahantering-och-grafer.html#cb81-8" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)                <span class="co"># Ta bort legenden (kopplingen mellan färg och album)</span></span>
<span id="cb81-9"><a href="datahantering-och-grafer.html#cb81-9" tabindex="-1"></a>g</span>
<span id="cb81-10"><a href="datahantering-och-grafer.html#cb81-10" tabindex="-1"></a></span>
<span id="cb81-11"><a href="datahantering-och-grafer.html#cb81-11" tabindex="-1"></a><span class="fu">ggplotly</span>(g)</span></code></pre></div>
</div>
<div class="exercise">
<p><span id="exr:unlabeled-div-22" class="exercise"><strong>Uppgift 1.22  (Interaktiv graf med andra axlar) </strong></span>Vi fortsätter med ett nytt exempel, nu med ett spridningsdiagram med album på y-axeln och valens på x-axeln. Funktionen <code>reorder()</code> ordnar en kolumn efter en annan. Här ordnas album efter release-år.</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="datahantering-och-grafer.html#cb82-1" tabindex="-1"></a>dat_small <span class="ot">&lt;-</span> dat <span class="sc">%&gt;%</span> </span>
<span id="cb82-2"><a href="datahantering-och-grafer.html#cb82-2" tabindex="-1"></a>  <span class="fu">filter</span>(artist_name <span class="sc">==</span> <span class="st">&quot;Rihanna&quot;</span>, album_type <span class="sc">==</span> <span class="st">&quot;album&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb82-3"><a href="datahantering-och-grafer.html#cb82-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Decade =</span> <span class="fu">floor</span>(album_release_year <span class="sc">/</span> <span class="dv">10</span>) <span class="sc">*</span> <span class="dv">10</span>,</span>
<span id="cb82-4"><a href="datahantering-och-grafer.html#cb82-4" tabindex="-1"></a>         <span class="at">Decade =</span> <span class="fu">as.character</span>(Decade),</span>
<span id="cb82-5"><a href="datahantering-och-grafer.html#cb82-5" tabindex="-1"></a>         <span class="at">album_name =</span> <span class="fu">reorder</span>(album_name, album_release_year))</span>
<span id="cb82-6"><a href="datahantering-och-grafer.html#cb82-6" tabindex="-1"></a></span>
<span id="cb82-7"><a href="datahantering-och-grafer.html#cb82-7" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dat_small, <span class="fu">aes</span>(valence, album_name, <span class="at">color =</span> Decade, <span class="at">text =</span> track_name)) <span class="sc">+</span></span>
<span id="cb82-8"><a href="datahantering-och-grafer.html#cb82-8" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span>
<span id="cb82-9"><a href="datahantering-och-grafer.html#cb82-9" tabindex="-1"></a>g</span></code></pre></div>
<p><img src="R-anvisningar_files/figure-html/unnamed-chunk-59-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Ändra gärna artist på lämpligt ställe.
Vad måste läggas till för en interaktiv version av samma graf?</p>
</div>
<p>Hemsidan <a href="https://plotly.com/r/" class="uri">https://plotly.com/r/</a> innehåller fler exempel för den som är intresserad.</p>
</div>
<div id="bonus.-warming-stripes" class="section level2 hasAnchor" number="1.9">
<h2><span class="header-section-number">1.9</span> Bonus. Warming stripes<a href="datahantering-och-grafer.html#bonus.-warming-stripes" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><em>Warming stripes</em> har sedan de först introducerades av Ed Hawking 2018 blivit en vanlig illustration av temperaturökning. I en warming stripe-graf anges varje år av en stapel och stapels färg ges av ett temperaturmått, vanligen årets medeltemperatur. I ggplot-terminologi har vi geometrier (staplar eller kolumner) med en x-position som ges av år och en ifylld färg som ges av temperatur.</p>
<p>För att göra en graf behöver vi data över temperaturer. Följande rad hämtar temperaturdata från Stockholm. Källa: <a href="https://miljobarometern.stockholm.se/klimat/klimat-och-vaderstatistik/medeltemperatur/" class="uri">https://miljobarometern.stockholm.se/klimat/klimat-och-vaderstatistik/medeltemperatur/</a></p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="datahantering-och-grafer.html#cb83-1" tabindex="-1"></a><span class="co"># Läs in data från fil</span></span>
<span id="cb83-2"><a href="datahantering-och-grafer.html#cb83-2" tabindex="-1"></a>dat_temp <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;https://raw.githubusercontent.com/adamflr/ST0060-2022/main/Data/Temperatur%2C%20Stockholm.csv&quot;</span>)</span></code></pre></div>
<p>Vi skapar nu en graf, som alltså ska ha en x-axeln given av år (<code>Year</code>) och ifylld färg som ges av temperatur (<code>Value</code>). Höjden ska vara densamma för alla staplar, men det spelar ingen roll vad den är (så länge den inte är noll).</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="datahantering-och-grafer.html#cb84-1" tabindex="-1"></a><span class="fu">ggplot</span>(dat_temp, <span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> <span class="dv">1</span>, <span class="at">fill =</span> Value)) <span class="sc">+</span></span>
<span id="cb84-2"><a href="datahantering-och-grafer.html#cb84-2" tabindex="-1"></a>  <span class="fu">geom_col</span>() </span></code></pre></div>
<p><img src="R-anvisningar_files/figure-html/unnamed-chunk-61-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="exercise">
<p><span id="exr:unlabeled-div-23" class="exercise"><strong>Uppgift 1.23  (Staplar utan mellanrum) </strong></span>Ett första problem är att staplarna inte fyller ytan. Man kan styra staplars bredd med argumentet <code>width</code>, t.ex.</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="datahantering-och-grafer.html#cb85-1" tabindex="-1"></a><span class="fu">ggplot</span>(dat_temp, <span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> <span class="dv">1</span>, <span class="at">fill =</span> Value)) <span class="sc">+</span></span>
<span id="cb85-2"><a href="datahantering-och-grafer.html#cb85-2" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">width =</span> <span class="fl">0.1</span>)</span></code></pre></div>
<p>Hitta ett värde för <code>width</code> som ger staplar utan mellanrum.</p>
</div>
<div class="exercise">
<p><span id="exr:unlabeled-div-24" class="exercise"><strong>Uppgift 1.24  (Färgval) </strong></span>Ett andra problem är att ggplots grundval för färger är från svart till blått. För klassiska warming stripes vill vi ha en skala från blått till rött. Färgerna i en skala ändras med särskilda <code>scale_()</code>-funktioner. En färgskala för ifylld färg kan sättas med <code>scale_fill_gradientn()</code>, till exempel</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="datahantering-och-grafer.html#cb86-1" tabindex="-1"></a><span class="fu">ggplot</span>(dat_temp, <span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> <span class="dv">1</span>, <span class="at">fill =</span> Value)) <span class="sc">+</span></span>
<span id="cb86-2"><a href="datahantering-och-grafer.html#cb86-2" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">width =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb86-3"><a href="datahantering-och-grafer.html#cb86-3" tabindex="-1"></a>  <span class="fu">scale_fill_gradientn</span>(<span class="at">colours =</span> <span class="fu">c</span>(<span class="st">&quot;darkgreen&quot;</span>, <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;white&quot;</span>, <span class="st">&quot;yellow&quot;</span>, <span class="st">&quot;purple&quot;</span>))</span></code></pre></div>
<p>Välj färger som ger en naturlig skala från blått till rött. Funktionen <code>colors()</code> ger valbara färger i R. Några möjliga val kan vara <code>darkblue</code>, <code>blue</code>, <code>white</code>, <code>red</code>, <code>salmon</code>, <code>darkred</code>, <code>steelblue</code> och <code>skyblue</code>.</p>
</div>
<div class="exercise">
<p><span id="exr:unlabeled-div-25" class="exercise"><strong>Uppgift 1.25  (Enkel graf) </strong></span>Slutligen brukar warming stripes presenteras med så lite kringinformation som möjligt. I ggplot kan grafelement tas bort med <code>theme()</code>. Här är som exempel en graf utan y-axel, tickmärken och legend.</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="datahantering-och-grafer.html#cb87-1" tabindex="-1"></a><span class="fu">ggplot</span>(dat_temp, <span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> Value)) <span class="sc">+</span></span>
<span id="cb87-2"><a href="datahantering-och-grafer.html#cb87-2" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb87-3"><a href="datahantering-och-grafer.html#cb87-3" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title =</span> <span class="fu">element_blank</span>(),            <span class="co"># Sätt titel till blank</span></span>
<span id="cb87-4"><a href="datahantering-och-grafer.html#cb87-4" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>,                <span class="co"># Ta bort legenden</span></span>
<span id="cb87-5"><a href="datahantering-och-grafer.html#cb87-5" tabindex="-1"></a>        <span class="at">plot.background =</span> <span class="fu">element_blank</span>(),       <span class="co"># Sätt bakgrunden till blank</span></span>
<span id="cb87-6"><a href="datahantering-och-grafer.html#cb87-6" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_blank</span>(),      <span class="co"># Sätt graffältets bakgrund till blank</span></span>
<span id="cb87-7"><a href="datahantering-och-grafer.html#cb87-7" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_blank</span>(),           <span class="co"># Sätt axeltext till blank</span></span>
<span id="cb87-8"><a href="datahantering-och-grafer.html#cb87-8" tabindex="-1"></a>        <span class="at">axis.ticks =</span> <span class="fu">element_blank</span>())            <span class="co"># Sätt axelticks till blank</span></span></code></pre></div>
<p>Använd temat från exemplet för att skapa en enklare version av grafen från föregående uppgift. Ett liknande resultat kan fås med temat <code>theme_void()</code>.</p>
</div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="installation-av-r-och-rstudio.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="beskrivande-statistik.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": false
},
"fontsettings": {
"theme": "sepia",
"family": "serif",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["R-anvisningar.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
